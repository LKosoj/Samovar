Для того, чтобы загрузить скетч в ESP32, необходимо установить программу Arduino IDE. Она используется как редактор скетчей, как компилятор скетчей, а так же для загрузки скомпилированной программы в ESP32

Ниже по ссылке подробно расписано, как установить Arduino IDE
https://alexgyver.ru/lessons/before-start/

Более подробно о работе с Arduino IDE можно прочитать тут:
https://alexgyver.ru/lessons/arduino-ide/

После установки Arduino IDE ее нужно научить работать с ESP32, по умолчанию она этого не умеет. Об этом - ниже по ссылке:
https://voltiq.ru/instruction-installing-esp32-board-in-arduino-ide-for-windows/

Если удалось скомпилировать пример, и загрузить его на ESP32 - можно переходить к настройке, компиляции и загрузке Самовара.

1. Скачиваем из GitHub архив (Code - Download zip) и распаковываем его на диске.
2. Копируем из архива каталог libraries в Документы/Arduino/
3. Копируем из архива каталог tools в Документы/Arduino/
4. Копируем из архива содержимое корневого каталога в Документы/Arduino/Samovar
5. Если запущена Arduino IDE ее необходимо закрыть, и открыть заново.
6. Открываем в Arduino IDE файл Samovar.ino
7. В меню Инструменты выбираем ESP32 Sketch Data Upload - содержимое каталога data установится на ESP32.
8. Выбираем файл Samovar_ini.h, и редактируем в нем параметры wi-fi, а так же, в случае необходимости, ключ для Blynk
9. Нажимаем кнопку - Загрузка, на ESP32 загрузится Самовар. В случае успеха можно открыть монитор com-порта (проверьте, что установлена скорость 115200), в мониторе вы должны увидеть сообщения об инициализации датчиков, и IP адрес, с которым Самовар подключился к вашей сети.
В процессе загрузки могут выводиться различные предупреждающие сообщения, их можно игнорировать. Если появится сообщение Connecting, но загрузка не начнется, а на экране будут появляться точки, необходимо на ESP32 на 3 секунды нажать кнопку Boot.

Как настроить драйвер шагового двигателя A4988:
https://alexgyver.ru/gyverstepper/

Для работы насоса достаточно напряжения 0.6V. Если нет вольтметра можно подстроечный резистр на драйвере установить в среднее положение. Если насос не крутится - можно чуть-чуть увеличить напряжение. Так же желательно смазать ролики насоса силиконовой смазкой. Это снизит трение, а следовательно нагрузку на шаговый двигатель, и повысит долговечность силиконовой трубки.

Для Самовара на драйвере нужно замкнуть вывод MS0 и VCC и в настройках Самовара в браузере указать примерное значение шагов на мл жидкости - 2050. Можно не замыкать вывод MS0, тогда количество шагов будет 1025. Точно подобрать шаги можно в настройках, пункт - калибровка насоса.

**Переходим к настройке скетча Samovar**

После тестовой загрузки откройте файл Samovar_ini.h в Arduino IDE. Он содержит в себе основные настройки скетча, которые можно менять. В других файлах, без опыта программирования, лучше ничего не менять.

Для начала необходимо настроить параметры подключения к wi-fi. Это делается в файле Samovar_ini.h

#define SAMOVAR_SSID "ssid" //указать название сети

#define SAMOVAR_PASSWORD "pwd" //указать свой пароль

//параметры подключения к Blynk

#define SAMOVAR_AUTH "auth-auth" //если планируется использовать Blynk - указать код из приложения Blynk.



Если вы не используете датчик потока, **обязательно отключите** его использование в скетче. Для этого необходимо в файле Samovar_ini.h изменить строку

#define USE_WATERSENSOR

на

//#define USE_WATERSENSOR

Так же, если не планируется использовать управляемый регулятор напряжения, необходимо строку

#define SAMOVAR_USE_POWER

изменить на

//#define SAMOVAR_USE_POWER



После внесения необходимых изменений надо еще раз загрузить скетч в ESP32, и можно перейти к настройкам самого Самовара.
Для этого необходимо открыть в браузере по адресу http://samovar.local.
Так же к Самовару можно подключиться по IP-адресу, который можно посмотреть мониторе компорта Arduino IDE - Инструменты - монитор порта. Для этого надо открыть монитор порта, установить скорость 115200 бод, отключить ESP32 от компьютера, и подключить заново. В мониторе порта появиться статус загрузки Самовара, в том числе и IP-адрес, с которым Самовар подключился к вашему роутеру.

**Внимание!**

В настройках программы обязательно необходимо указать параметры уставки датчика пара перед дефлегматором и датчика в царге. Без этого Самовар будет работать не корректно. Для начала можно поставить 0.5 для датчика пара и 1 для датчика в царге. Потом эти параметры можно изменить.
