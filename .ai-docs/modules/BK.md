# BK

/**
 * @brief Модуль управления бражной колонной. Обеспечивает автоматическое управление нагревом, 
 * контроль температурных параметров, защиту от аварийных ситуаций и взаимодействие с периферийными 
 * устройствами (насос, клапан, буззер). Поддерживает интеграцию с MQTT и управление мощностью 
 * через ШИМ или внешний регулятор.
 *
 * Ключевые структуры данных
 * MESSAGE_TYPE — Тип сообщения для отправки уведомлений (например, уведомление, предупреждение, авария)
 */

---
void bk_finish()
Завершает работу бражной колонны: останавливает процесс, отправляет уведомление и сбрасывает параметры.
Аргументы
Возвращает
Исключения

---
void set_power_mode(String Mode)
Устанавливает режим питания бражной колонны.
Аргументы
Mode — Режим питания в виде строки (например, "работа", "разгон")
Возвращает
Исключения

---
void set_current_power(float power)
Устанавливает текущую мощность нагрева в ваттах.
Аргументы
power — Мощность в ваттах
Возвращает
Исключения

---
void set_buzzer(bool On)
Включает или выключает звуковой сигнал (бuzzer).
Аргументы
On — true для включения, false для выключения
Возвращает
Исключения

---
void reset_sensor_counter()
Сбрасывает счётчики измерений температурных датчиков.
Аргументы
Возвращает
Исключения

---
void check_power_error()
Проверяет наличие ошибок в системе питания и выполняет соответствующие действия.
Аргументы
Возвращает
Исключения

---
void set_power(bool On)
Включает или выключает подачу питания на нагреватель.
Аргументы
On — true для включения, false для выключения
Возвращает
Исключения

---
void create_data()
Создаёт файл для записи данных текущей сессии дистилляции.
Аргументы
Возвращает
Исключения

---
void open_valve(bool Val, bool msg)
Открывает или закрывает клапан подачи пара.
Аргументы
Val — true для открытия, false для закрытия
msg — true для отправки уведомления о состоянии клапана
Возвращает
Исключения

---
void set_pump_pwm(float duty)
Устанавливает значение ШИМ для управления насосом подачи воды.
Аргументы
duty — Значение ШИМ (0–100%)
Возвращает
Исключения

---
void set_pump_speed_pid(float temp)
Регулирует скорость насоса по ПИД-алгоритму на основе целевой температуры.
Аргументы
temp — Целевая температура для регулирования
Возвращает
Исключения

---
void SendMsg(const String& m, MESSAGE_TYPE msg_type)
Отправляет сообщение пользователю через доступные интерфейсы (например, MQTT, дисплей).
Аргументы
m — Текст сообщения
msg_type — Тип сообщения (уведомление, предупреждение, авария)
Возвращает
Исключения

---
bool check_boiling()
Проверяет, началось ли кипение в бражной колонне на основе анализа температур.
Аргументы
Возвращает
true, если кипение обнаружено, иначе false
Исключения

---
void set_water_temp(float duty)
Устанавливает температуру воды путём регулировки ШИМ насоса охлаждения.
Аргументы
duty — Значение ШИМ для управления температурой воды
Возвращает
Исключения

---
void bk_proc()
Основной цикл обработки работы бражной колонны: управление нагревом, контроль температуры, запуск сессии.
Аргументы
Возвращает
Исключения

---
void check_alarm_bk()
Проверяет аварийные условия (перегрев, отсутствие воды) и выполняет защитные действия.
Аргументы
Возвращает
Исключения
