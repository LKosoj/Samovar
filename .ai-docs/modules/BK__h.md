# BK

/**
 * @file SamovarBk.h
 * @brief Модуль управления работой бражной колонны.
 *
 * Обеспечивает логику управления нагревом, охлаждением и безопасностью при работе бражной колонны.
 * Включает функции контроля температуры, управления насосом и клапаном, обработки аварийных ситуаций.
 * Поддерживает интеграцию с MQTT и ШИМ-управлением насосом при наличии соответствующих опций.
 *
 * Ключевые структуры данных
 * MESSAGE_TYPE — Тип сообщения для отправки уведомлений (например, уведомление, предупреждение, авария)
 */

---
void bk_finish()
Завершить работу бражной колонны, отправить уведомление, выключить нагрев и сбросить счетчики.
Аргументы
Возвращает
Исключения

---
void set_power_mode(String Mode)
Установить режим питания.
Аргументы
Mode — Режим (строка)
Возвращает
Исключения

---
void set_current_power(float power)
Установить текущую мощность.
Аргументы
power — Мощность (Вт)
Возвращает
Исключения

---
void set_buzzer(bool On)
Включить или выключить буззер.
Аргументы
On — true — включить, false — выключить
Возвращает
Исключения

---
void reset_sensor_counter()
Сбросить счетчик датчиков.
Аргументы
Возвращает
Исключения

---
void check_power_error()
Проверить ошибки питания и обработать их.
Аргументы
Возвращает
Исключения

---
void set_power(bool On)
Включить или выключить питание.
Аргументы
On — true — включить, false — выключить
Возвращает
Исключения

---
void create_data()
Создать файл с данными текущей сессии.
Аргументы
Возвращает
Исключения

---
void open_valve(bool Val, bool msg)
Открыть или закрыть клапан.
Аргументы
Val — true — открыть, false — закрыть
msg — true — отправить сообщение
Возвращает
Исключения

---
void set_pump_pwm(float duty)
Установить ШИМ для насоса.
Аргументы
duty — Значение ШИМ
Возвращает
Исключения

---
void set_pump_speed_pid(float temp)
Установить скорость насоса по ПИД-регулированию.
Аргументы
temp — Целевая температура
Возвращает
Исключения

---
void SendMsg(const String& m, MESSAGE_TYPE msg_type)
Отправить сообщение пользователю.
Аргументы
m — Текст сообщения
msg_type — Тип сообщения
Возвращает
Исключения

---
bool check_boiling()
Проверить, идет ли кипячение.
Аргументы
Возвращает
true если кипит, иначе false
Исключения

---
void set_water_temp(float duty)
Установить температуру воды (ШИМ).
Аргументы
duty — Значение ШИМ
Возвращает
Исключения

---
void bk_proc()
Основной цикл работы бражной колонны. Запускает нагрев, проверяет условия завершения.
Аргументы
Возвращает
Исключения

---
void check_alarm_bk()
Проверка и обработка аварийных ситуаций в работе бражной колонны.
Аргументы
Возвращает
Исключения
