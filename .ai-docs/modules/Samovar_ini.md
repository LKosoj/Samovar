# Samovar_ini

Конфигурационный заголовочный файл для системы управления "Самовар" на базе ESP32.  
Модуль содержит определения констант, параметров и настроек, используемых в системе автоматики для контроля процессов нагрева, охлаждения, перегонки и ректификации в самогонных аппаратах. Включает пороги температур, настройки ШИМ, параметры взаимодействия с внешними устройствами (регуляторы мощности, датчики, насосы, Blynk, MQTT) и специфичные для аппаратной платформы опции.

Ключевые структуры данных  
servoDelta — массив коррекции угла поворота сервопривода для компенсации механических отклонений в 11 точках диапазона  
---

#define SAMOVAR_HOST "samovar"  
Имя хоста устройства в сети. Используется для идентификации ESP32 в Wi-Fi и сетевых сервисах.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define ALARM_WATER_TEMP 70  
Порог температуры воды (в °C), при котором формируется предупреждение оператору.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define MAX_WATER_TEMP 75  
Максимальная допустимая температура воды (в °C), при превышении которой отключается питание нагревателя.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define MAX_STEAM_TEMP 98.8  
Максимальная допустимая температура пара (в °C), при превышении которой отключается питание.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define MAX_ACP_TEMP 75  
Максимальная допустимая температура в термостатируемой камере (ТСА) (в °C), при превышении которой отключается нагрев.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define CHANGE_POWER_MODE_STEAM_TEMP 39  
Температура пара (в °C), при достижении которой колонна переходит из режима разгона в рабочий режим или определяется начало кипения в режиме дистилляции.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define OPEN_VALVE_TANK_TEMP 77  
Температура в кубе (в °C), при достижении которой открывается клапан и включается насос подачи воды.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define DELTA_T_CLOSE_VALVE 20  
Разница (в °C) между целевой и текущей температурой воды, при достижении которой насос охлаждения останавливается после завершения перегонки.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define PWM_LOW_VALUE 10  
Минимальное значение ШИМ (в %), при котором насос продолжает работать после запуска.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define PWM_START_VALUE 40  
Начальное значение ШИМ (в %), необходимое для надежного запуска насоса.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define HEAT_DELTA 1  
Разница (в °C) между целевой и текущей температурой, при которой нагрев в режимах "пиво" и "су-вид" осуществляется на полной мощности.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define ACCELERATION_HEATER_DELTA 4  
Порог (в °C), при превышении которого включается разгонный ТЭН через реле 4 при использовании UART-регулятора.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define BOILING_TEMP 98.9  
Температура кипения воды в режиме "пиво" (в °C), используемая как ориентир для управления процессом.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define SAMOVAR_USE_BLYNK  
Определяет использование платформы Blynk для удалённого управления и мониторинга устройства.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define BLYNK_SAMOVAR_TOOL "samovar-tool.ru"  
Адрес локального сервера Blynk, используемого вместо облачного сервиса.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_MQTT  
Активирует отправку логов устройства в облачную систему через MQTT (требует настройки токена на samovar-tool.ru).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define SAMOVAR_USE_POWER  
Включает поддержку регулятора напряжения, управляемого по UART (например, KVIC, РМВК, SEM AVR).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define KVIC_USE_9600  
Устанавливает скорость UART 9600 бод для регулятора KVIC (иначе используется 38400 бод).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define SAMOVAR_USE_RMVK  
Активирует использование регулятора мощности РМВК с UART-управлением.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define SAMOVAR_USE_SEM_AVR  
Активирует использование регулятора мощности SEM AVR с UART-управлением.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define NBK_MULT_PAUSE_OVERFLOW 2  
Количество инерционных циклов ожидания после захлёба в системе НБК (нейтрализатор браги).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define NBK_PUMP_LIMIT 30  
Максимальная производительность насоса браги в НБК (в л/ч) для оптимизации работы.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define NBK_DEFAULT_PROGRAM "H;1;0\nS;10;2000\nO;0;0\nW;0;0\n"  
Строка программы по умолчанию для НБК. Значения зависят от типа регулятора (вольты или ватты).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define SAMOVAR_USE_POWER_START_TIME 2000  
Задержка (в мс) перед отправкой команды разгона регулятору, чтобы обеспечить его полную инициализацию после включения.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_WATERSENSOR  
Активирует контроль потока охлаждающей воды. При отсутствии потока в течение заданного времени нагрев отключается.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define WF_CALIBRATION 98  
Коэффициент калибровки датчика потока воды: F = 98 × Q (л/мин). Используется для перевода импульсов в расход.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_HEAD_LEVEL_SENSOR  
Включает использование датчика уровня флегмы в головке колонны (типа P-N-P) для контроля захлёбывания.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define IGNORE_HEAD_LEVEL_SENSOR_SETTING  
Запрещает отключение датчика уровня флегмы через веб-интерфейс.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define WHLS_HIGH_PULL  
Использует датчик уровня жидкости типа N-P-N (активный при высоком уровне).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_WATER_PUMP  
Включает управление водяным насосом через ШИМ, а также может использоваться для включения мешалки в режиме пивоварения.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_WATER_VALVE LOW  
Активирует управление клапаном подачи воды; параметр LOW указывает, что клапан открывается при низком уровне сигнала.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_ALARM_BTN  
Включает поддержку аварийной кнопки или датчиков протечки; при срабатывании останавливается подача воды и отключается питание.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BODY_TEMP_AUTOSET  
Включает автоматическую коррекцию температуры тела в первой программе отбора после голов или в режиме предзахлеба.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BMP180  
Использует датчик давления BMP180/BMP085 для измерения атмосферного давления.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BMP280  
Использует датчик давления BMP280 для измерения атмосферного давления.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BMP280_ALT  
Использует датчик давления BMP280 с альтернативным I2C-адресом.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BME280  
Использует датчик давления BME280 (давление, температура, влажность).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BME680  
Использует датчик давления BME680 (давление, температура, влажность, газ).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_BTN  
Активирует поддержку кнопки управления на устройстве.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_UPDATE_OTA  
Включает обновление прошивки по Wi-Fi через ArduinoOTA; рекомендуется использовать только при отладке.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_EXPANDER 0x20  
Подключает расширитель портов PCF8575 по I2C-адресу 0x20 для увеличения цифровых выходов/входов.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_ANALOG_EXPANDER 0x48  
Подключает аналоговый расширитель портов PCF8591 по I2C-адресу 0x48.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_LUA  
Позволяет использовать скрипты на языке Lua для управления устройством и расширителями.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_PRESSURE_XGZ 32  
Использует датчик давления XGZP6897D с коэффициентом калибровки 32 (значение К из таблицы).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_PRESSURE_1WIRE {0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x22, 0x55}  
Использует датчик давления, подключённый по шине 1-Wire, с указанным уникальным ROM-адресом.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_PRESSURE_MPX  
Использует аналоговый датчик давления MPX5010D.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_STEPPER_ACCELERATION  
Включает плавный старт и торможение шагового двигателя для снижения нагрузки и вибраций.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define STEPPER_REVERSE  
Изменяет направление вращения шагового двигателя на противоположное.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define I2CStepperStepMl 16000  
Задаёт количество шагов шагового двигателя на один миллилитр жидкости (для I2C-контроллера шагового двигателя).  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define COLUMN_WETTING  
Активирует режим смачивания насадки колонны перед началом ректификации до уровня предзахлеба.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define WETTING_POWER 220  
Устанавливает мощность (напряжение) нагрева при смачивании насадки, используется в режиме SEM_AVR.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define USE_TELEGRAM  
Включает отправку уведомлений в Telegram; требует настройки токена бота и ID пользователя.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define NOT_USE_INTERFACE_UPDATE  
Отключает автоматическое обновление веб-интерфейса при запуске устройства.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—

---

#define KVIC_DEBUG  
Активирует режим отладки для диагностики работы системы.  
Аргументы  
—  
Возвращает  
—  
Исключения  
—
