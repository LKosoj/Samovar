# mod_rmvk

/**
 * @brief Модуль предоставляет интерфейс для взаимодействия с устройством РМВ-К через UART.
 * Реализует инициализацию UART, отправку AT-команд, чтение и установку параметров устройства: напряжения, состояния, ячеек памяти.
 * Поддерживает асинхронное чтение состояния через задачу FreeRTOS и предоставляет доступ к текущему состоянию через глобальную структуру.
 *
 * Ключевые структуры данных
 * rmvk_t — структура, хранящая текущее состояние устройства: флаги подключения, включения, входного и выходного напряжений, установленного значения.
 */

---
void RMVK_init(void)
Инициализирует UART для взаимодействия с РМВ-К.
Аргументы
Возвращает
Исключения

---
void rmvk_read()
Синхронно читает и обновляет состояние РМВ-К по UART.
Аргументы
Возвращает
Исключения

---
void rmvkFn(void* arg)
Функция задачи FreeRTOS для периодического опроса состояния РМВ-К.
Аргументы
arg — указатель на аргумент (не используется).
Возвращает
Исключения

---
uint8_t RMVK_cmd(const char* cmd, rmvk_res_t res)
Отправляет AT-команду устройству и ожидает ожидаемый ответ.
Аргументы
cmd — строка с AT-командой.
res — ожидаемый тип ответа (RMVK_INT, RMVK_OK, RMVK_ON).
Возвращает
1 при успешном получении ожидаемого ответа, 0 в случае ошибки или таймаута.
Исключения

---
uint16_t RMVK_set_out_voltge(uint16_t voltge)
Устанавливает выходное напряжение на РМВ-К.
Аргументы
voltge — целевое напряжение в вольтах (допустимо от 40 до 230).
Возвращает
Установленное напряжение при успехе, 0 при ошибке или недопустимом значении.
Исключения

---
uint16_t RMVK_set_state(uint16_t new_state)
Устанавливает состояние выхода (включено/выключено) через команду АТ+ON.
Аргументы
new_state — 1 для включения, 0 для выключения.
Возвращает
1 при успешной установке, 0 при ошибке.
Исключения

---
uint16_t RMVK_set_on(uint16_t state)
Алиас для RMVK_set_state — управляет включением выхода.
Аргументы
state — 1 для включения, 0 для выключения.
Возвращает
1 при успехе, 0 при ошибке.
Исключения

---
uint16_t RMVK_select_mem(uint16_t sm)
Выбирает напряжение из указанной ячейки памяти (0–9).
Аргументы
sm — номер ячейки памяти (0–9).
Возвращает
1 при успешном выборе, 0 при ошибке (недопустимый номер).
Исключения

---
uint16_t RMVK_get_in_voltge()
Запрашивает текущее входное напряжение.
Аргументы
Возвращает
Текущее входное напряжение в вольтах или 0 при ошибке.
Исключения

---
uint16_t RMVK_get_out_voltge()
Запрашивает текущее реальное выходное напряжение.
Аргументы
Возвращает
Реальное выходное напряжение в вольтах или 0 при ошибке.
Исключения

---
uint16_t RMVK_get_store_out_voltge()
Запрашивает установленное (целевое) выходное напряжение.
Аргументы
Возвращает
Целевое выходное напряжение в вольтах или 0 при ошибке.
Исключения

---
bool RMVK_get_state()
Проверяет, включено ли выходное напряжение.
Аргументы
Возвращает
true, если выход включён (ON), иначе false.
Исключения

---
bool RMVK_get_conn()
Проверяет, установлено ли соединение с РМВ-К.
Аргументы
Возвращает
true, если соединение активно, иначе false.
Исключения

---
uint8_t get_rmvk_state()
Возвращает текущее состояние включения из глобальной структуры.
Аргументы
Возвращает
Значение поля `on` из структуры `rmvk`.
Исключения

---
uint8_t get_rmvk_conn()
Возвращает текущий статус подключения из глобальной структуры.
Аргументы
Возвращает
Значение поля `conn` из структуры `rmvk`.
Исключения

---
extern rmvk_t rmvk
Глобальная структура, содержащая актуальное состояние устройства РМВ-К.
Поля
conn — флаг подключения к устройству.
on — флаг включения выхода.
VI — входное напряжение (в вольтах, кэшировано).
VO — реальное выходное напряжение (в вольтах, кэшировано).
VS — установленное выходное напряжение (в вольтах, кэшировано).
Методы
