# crash_handler

/**
 * @file CrashHandler.h
 * @brief Модуль обработки сбоев для ESP32 в проекте Samovar.
 *
 * Предоставляет функциональность для перехвата и сохранения стектрейсов при критических сбоях,
 * а также анализа причин перезагрузки системы. При отключённой опции USE_CRASH_HANDLER
 * все функции компилируются как пустые заглушки.
 */

Ключевые структуры данных  
STACKTRACE_MAX_SIZE — Максимальный размер буфера для хранения стектрейса (в байтах)

void init_crash_handler()  
Инициализирует обработчик сбоев, устанавливая системные колбэки для перехвата паник и исключений  
Аргументы  
Возвращает  
Исключения

---
void save_stacktrace_to_file(const char* info)  
Сохраняет текущий стектрейс в файл на SPIFFS с указанным поясняющим сообщением  
Аргументы  
info — Поясняющая строка, описывающая контекст сохранения стектрейса (например, причина сбоя)  
Возвращает  
Исключения

---
String get_reset_reason_string()  
Возвращает строковое описание причины последней перезагрузки системы  
Аргументы  
Возвращает  
Человекочитаемая строка с причиной сброса (например, "Software Watchdog", "Power On", "Fatal exception")  
Исключения

---
void check_and_load_crash_log()  
Проверяет наличие сохранённого лога сбоя при старте системы и, если найден, загружает его для анализа  
Аргументы  
Возвращает  
Исключения

---
void force_save_stacktrace(const char* reason)  
Принудительно сохраняет текущий стектрейс в файл, даже если сбой не зафиксирован  
Аргументы  
reason — Причина, по которой был вызван принудительный дамп стектрейса  
Возвращает  
Исключения
