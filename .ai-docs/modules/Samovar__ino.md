# Samovar

Модуль представляет собой комплексное программное обеспечение для управления самоваром на базе ESP32 с поддержкой множества датчиков, интерфейсов и режимов работы (дистилляция, пивоварение и др.). Он включает в себя логику управления температурой, уровнем воды, работой шагового двигателя, а также поддержку веб-интерфейса, OTA-обновлений, MQTT, Blynk и Telegram. Архитектура модуля построена на использовании асинхронных серверов, PID-регулирования, EEPROM/NVS-хранилища профилей и обработки внешних событий через прерывания.

Ключевые структуры данных  
Samovar — Основной класс управления состоянием и режимами работы самовара  
Preferences — Хранилище параметров в NVS (Non-Volatile Storage)  
GyverPID — PID-регулятор для точного управления температурой  
SimpleStringQueue — Очередь строк для асинхронной отправки сообщений (например, в Telegram)

---
void stopService(void)  
Останавливает таймер управления шаговым двигателем  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void startService(void)  
Запускает таймер с периодом, заданным шаговым двигателем, для управления его движением  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void IRAM_ATTR StepperTicker(void)  
Обработчик прерывания для тика шагового двигателя; вызывается по таймеру  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void IRAM_ATTR WFpulseCounter(void)  
Считает импульсы от датчика потока воды (если включён USE_WATERSENSOR)  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void IRAM_ATTR isrWHLS_TICK(void)  
Обработчик прерывания для датчика уровня головы (при использовании USE_HEAD_LEVEL_SENSOR)  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void triggerGetClock(void *parameter)  
Задача FreeRTOS для периодического получения точного времени через NTP  
Аргументы  
parameter — указатель на параметры задачи (не используется)  
Возвращает  
нет  
Исключения  
нет

---
void load_profile_nvs()  
Загружает профиль настроек из NVS (Preferences) в текущее состояние системы  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void migrate_from_eeprom()  
Выполняет миграцию данных настроек из устаревшего EEPROM в NVS при первом запуске  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void setupMenu()  
Инициализирует и настраивает меню на LCD-дисплее с использованием библиотеки LiquidMenu  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void WebServerInit(void)  
Инициализирует асинхронный веб-сервер с обработчиками API, статических файлов и OTA  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void encoder_getvalue()  
Считывает состояние энкодера и обновляет текущий фокус меню или значение параметра  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void menu_calibrate()  
Запускает режим калибровки датчиков (температуры, уровня и др.) через меню  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void set_body_temp()  
Устанавливает целевую температуру корпуса самовара в зависимости от режима  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void distiller_finish()  
Завершает процесс дистилляции: останавливает нагрев, сохраняет данные, отправляет уведомления  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void beer_finish()  
Завершает процесс пивоварения: останавливает процессы, сохраняет результаты, уведомляет пользователя  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void change_samovar_mode()  
Переключает текущий режим работы самовара (дистилляция, пиво, выключено и т.д.)  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void verbose_print_reset_reason()  
Выводит в Serial подробную информацию о причине последнего сброса ESP32  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void set_alarm()  
Активирует сигнализацию (звуковую или визуальную) при достижении критических условий  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
void menu_switch_focus()  
Переключает фокус между элементами меню на дисплее  
Аргументы  
нет  
Возвращает  
нет  
Исключения  
нет

---
float get_steam_alcohol(float t)  
Рассчитывает ожидаемую крепость пара (в %) по температуре дистиллята  
Аргументы  
t — температура пара в градусах Цельсия  
Возвращает  
Оценка крепости пара в процентах (0–100)  
Исключения  
нет

---
float get_alcohol(float t)  
Рассчитывает текущую крепость дистиллята по температуре (на основе калибровочной кривой)  
Аргументы  
t — температура в градусах Цельсия  
Возвращает  
Оценка крепости в процентах  
Исключения  
нет

---
String http_sync_request_get(String url)  
Выполняет синхронный HTTP GET-запрос по указанному URL  
Аргументы  
url — адрес для запроса  
Возвращает  
Тело ответа в виде строки  
Исключения  
нет

---
class Samovar  
Основной класс управления самоваром: режимы, датчики, исполнительные устройства  
Поля  
mode — текущий режим работы (дистилляция, пиво и т.д.)  
targetTemp — целевая температура  
currentTemp — текущая температура от датчика  
isHeating — флаг активности нагрева  
profile — активный профиль настроек  
Методы  
void begin() — инициализирует все подсистемы самовара  
void update() — обновляет состояние системы (температура, меню, PID)  
void setMode(int m) — устанавливает режим работы  
void handleTemperature() — обрабатывает данные с датчиков температуры  
void controlHeater() — управляет включением/выключением нагрева на основе PID

---
class GyverPID  
PID-регулятор для точного управления температурой нагрева  
Поля  
setpoint — целевое значение (температура)  
input — текущее значение (с датчика)  
output — выходное значение (управление нагревателем)  
Kp, Ki, Kd — коэффициенты PID  
Методы  
void setCoefficients(float p, float i, float d) — задаёт коэффициенты регулятора  
float compute() — вычисляет новое значение выхода на основе входа и уставки  
void setDirection(bool direction) — задаёт направление регулирования (прямое/обратное)

---
class SimpleStringQueue  
Очередь строк для асинхронной обработки сообщений (например, уведомлений)  
Поля  
maxStrings — максимальное количество строк в очереди  
maxLength — максимальная длина одной строки  
Методы  
bool push(String &str) — добавляет строку в очередь; возвращает false при переполнении  
String pop() — извлекает строку из очереди; возвращает пустую строку, если очередь пуста  
bool isEmpty() — возвращает true, если очередь пуста

---
void triggerSysTicker(void *parameter)  
Краткий запуск системного тикера для периодических проверок и обновлений  
Аргументы  
parameter — Указатель на параметры задачи (не используется)  
Возвращает  
Ничего не возвращает (бесконечный цикл задачи FreeRTOS)  
Исключения  
Нет исключений

---
void handleSystemTasks()  
Основная функция обработки фоновых системных операций: переподключение, отправка сообщений, задержки  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
class lua  
Интерфейс выполнения пользовательских Lua-скриптов  
Поля  
btn_script — Скрипт, запускаемый по событию кнопки  
loop_lua_fl — Флаг активации циклического выполнения скрипта  
show_lua_script — Флаг вывода скрипта в лог  
Методы  
String Lua_dostring(String *script) — Выполняет Lua-скрипт и возвращает результат или сообщение об ошибке

---
String append_data()  
Формирует строку данных для логирования с текущими показаниями датчиков  
Аргументы  
Нет аргументов  
Возвращает  
Строка с разделёнными запятыми значениями датчиков и временем  
Исключения  
Нет исключений

---
void SendMsg(const char* msg, uint8_t msgType)  
Помещает сообщение в очередь на отправку внешним сервисам (Telegram, Blynk и др.)  
Аргументы  
msg — Текст сообщения  
msgType — Тип сообщения (например, ALARM_MSG)  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
void connectToMqtt()  
Выполняет подключение к MQTT-брокеру с использованием настроек из SamSetup  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
void update_heat_loss_calculation()  
Обновляет расчёт теплопотерь во время нагрева на основе текущих данных температуры и энергопотребления  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
void get_current_power()  
Измеряет текущее энергопотребление (напряжение, ток, мощность) при наличии соответствующего датчика  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
void DS_getvalue()  
Считывает текущие значения с датчиков температуры по шине 1-Wire  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
void BME_getvalue(bool force)  
Считывает данные с датчика BME (температура, влажность, давление)  
Аргументы  
force — Принудительное измерение, игнорируя кэш  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
void pressure_sensor_get()  
Считывает значение давления с цифрового датчика (XGZ, MPX и др.)  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
String format_float(float value, int decimalPlaces)  
Форматирует число с плавающей точкой в строку с заданным количеством знаков после запятой  
Аргументы  
value — Значение для форматирования  
decimalPlaces — Количество знаков после запятой  
Возвращает  
Отформатированная строка  
Исключения  
Нет исключений

---
String urlEncode(String str)  
Кодирует строку в формат URL-encoding (процентное кодирование)  
Аргументы  
str — Исходная строка  
Возвращает  
Закодированная строка  
Исключения  
Нет исключений

---
void start_lua_script()  
Запускает выполнение циклического Lua-скрипта, если включён флаг loop_lua_fl  
Аргументы  
Нет аргументов  
Возвращает  
Ничего не возвращает  
Исключения  
Нет исключений

---
float get_steam_alcohol(float sensorTemp)  
Возвращает оценку крепости пара на основе температуры датчика  
Аргументы  
sensorTemp — температура датчика (в градусах Цельсия)  
Возвращает  
Оценка крепости пара в процентах (0–100)  
Исключения  
нет

---
String format_float(float value, uint8_t decimals)  
Форматирует число с плавающей точкой в строку с заданным числом знаков после запятой  
Аргументы  
value — форматируемое значение  
decimals — количество знаков после запятой  
Возвращает  
Строка с отформатированным числом  
Исключения  
нет

---
void MqttSendMsg(String &msg, const char *topic, int qos)  
Отправляет сообщение через MQTT-брокер  
Аргументы  
msg — ссылка на строку с данными  
topic — целевой топик (например, "log")  
qos — уровень качества сообщения (0, 1, 2)  
Возвращает  
Нет  
Исключения  
Может выбрасывать исключения при разрыве соединения (зависит от реализации MQTT-клиента)

---
void check_alarm()  
Проверяет критические параметры в режиме ректификации и при необходимости отключает нагрев  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Аварийное отключение нагрева при превышении температурных или других порогов

---
void check_alarm_distiller()  
Проверяет критические параметры в режиме дистилляции и при необходимости отключает нагрев  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Аварийное отключение нагрева при превышении температурных или других порогов

---
void check_alarm_bk()  
Проверяет критические параметры в режиме БК и при необходимости отключает нагрев  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Аварийное отключение нагрева при превышении температурных или других порогов

---
void check_alarm_nbk()  
Проверяет критические параметры в режиме НБК и при необходимости отключает нагрев  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Аварийное отключение нагрева при превышении температурных или других порогов

---
void check_alarm_beer()  
Проверяет критические параметры в режиме пивоварения и при необходимости отключает нагрев  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Аварийное отключение нагрева при превышении температурных или других порогов

---
class ImpurityDetector  
Детектирует появление примесей по изменению температурного тренда  
Поля  
currentTrend — текущее значение тренда изменения температуры (град/мин)  
detectorStatus — статус детектора (0=норма, 1=обнаружена примесь)  
Методы  
void update(float currentTemp, float deltaTime) — обновляет состояние детектора на основе текущей температуры и прошедшего времени  
float getTrend() — возвращает текущее значение температурного тренда  
uint8_t getStatus() — возвращает статус обнаружения примеси

---
void setup()  
Инициализирует аппаратные и программные компоненты системы при запуске устройства.  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
void loop()  
Основной цикл управления устройством, выполняющийся в задаче FreeRTOS.  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
class Stepper  
Управляет шаговым двигателем, отвечающим за регулировку подачи воды.  
Поля  
enablePin — номер пина включения драйвера двигателя  
stepPin — номер пина шага  
dirPin — номер пина направления  
Методы  
void enable() — включает питание двигателя  
void disable() — отключает питание двигателя  
void setSpeed(int speed) — устанавливает скорость вращения (в шагах в секунду)  
void step() — выполняет один шаг двигателя  
void setDirection(bool dir) — задаёт направление вращения (true — вперёд)  
void tick() — обновляет состояние двигателя по таймеру

---
class Button  
Обрабатывает ввод с кнопки с поддержкой антидребезга и различных типов нажатий.  
Поля  
pin — номер пина кнопки  
type — тип подтяжки (HIGH_PULL или LOW_PULL)  
debounceTime — время антидребезга в миллисекундах  
Методы  
void setType(uint8_t type) — устанавливает тип подтяжки пина  
void setDebounce(uint32_t ms) — задаёт время антидребезга  
void setTickMode(uint8_t mode) — устанавливает режим опроса (ручной или автоматический)  
void tick() — обновляет состояние кнопки  
bool isPress() — возвращает true, если кнопка нажата  
bool isClick() — возвращает true при одиночном клике  
bool isHold() — возвращает true при удержании кнопки

---
class Encoder  
Обрабатывает сигналы с энкодера для определения направления и количества поворотов.  
Поля  
pin1 — первый сигналовой пин энкодера  
pin2 — второй сигналовой пин энкодера  
Методы  
void tick() — обновляет состояние энкодера  
int8_t getDirection() — возвращает направление поворота (-1 — против часовой, 1 — по часовой, 0 — нет движения)  
int32_t getCount() — возвращает суммарное количество шагов поворота

---
void StepperTicker()  
Обработчик прерывания по таймеру для управления шагами двигателя.  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
void SendMsg(const String &msg, uint8_t msgType)  
Отправляет сообщение указанного типа (например, тревогу) через систему оповещения.  
Аргументы  
msg — текст сообщения  
msgType — тип сообщения (например, ALARM_MSG)  
Возвращает  
Нет  
Исключения  
Нет

---
bool check_I2C_device(uint8_t addr)  
Проверяет наличие устройства по указанному I2C-адресу.  
Аргументы  
addr — I2C-адрес устройства  
Возвращает  
true, если устройство отвечает, иначе false  
Исключения  
Нет

---
void read_config()  
Считывает конфигурацию устройства из NVS и заполняет структуру SamSetup.  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
void save_profile()  
Сохраняет текущую конфигурацию из структуры SamSetup в NVS.  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
void reset_migration_flag()  
Сбрасывает флаг миграции в EEPROM, принудительно разрешая повторную миграцию (используется только для тестирования).  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
class WiFi  
Интерфейс управления подключением к Wi-Fi сети.  
Методы  
void mode(wifi_mode_t) — устанавливает режим работы Wi-Fi (STA, AP или комбинированный)  
bool begin() — инициирует подключение к сохранённой Wi-Fi сети  
void disconnect(bool) — отключается от сети; при false не удаляет сохранённые учётные данные  
wl_status_t status() — возвращает текущий статус подключения  
String SSID() — возвращает имя подключённой сети  
IPAddress localIP() — возвращает локальный IP-адрес в сети  
IPAddress softAPIP() — возвращает IP-адрес точки доступа  
bool softAP(const char*) — запускает режим точки доступа без пароля

---
void ArduinoOTA.onStart(OTA_CALLBACK(fn))  
Регистрирует функцию-обработчик, вызываемую при начале OTA-обновления прошивки.  
Аргументы  
fn — указатель на функцию, выполняемую при старте OTA  
Возвращает  
Нет  
Исключения  
Нет

---
bool MDNS.begin(const char* host)  
Инициализирует mDNS-резолвер, позволяя обращаться к устройству по имени (например, http://samovar.local).  
Аргументы  
host — имя хоста для регистрации в сети  
Возвращает  
true при успешной инициализации, иначе false  
Исключения  
Нет

---
void ArduinoOTA.onStart([]() { ... })  
Обработчик начала OTA-обновления  
Аргументы  
— — Устанавливает флаг `ota_running`, отправляет событие о начале обновления, отключает сторонние сервисы (Blynk, MQTT)  
Возвращает  
void  
Исключения  
Нет

---
void ArduinoOTA.onEnd([]() { ... })  
Обработчик завершения OTA-обновления  
Аргументы  
— — Сбрасывает флаг `ota_running`, отправляет событие об окончании обновления  
Возвращает  
void  
Исключения  
Нет

---
void ArduinoOTA.onProgress([](unsigned int progress, unsigned int total) { ... })  
Обработчик отображения прогресса OTA-обновления  
Аргументы  
progress — Текущее количество принятых байт  
total — Общий объём данных обновления  
Возвращает  
void  
Исключения  
Нет

---
void ArduinoOTA.onError([](ota_error_t error) { ... })  
Обработчик ошибок при OTA-обновлении  
Аргументы  
error — Код ошибки OTA (например, OTA_AUTH_ERROR, OTA_BEGIN_ERROR и др.)  
Возвращает  
void  
Исключения  
Нет

---
void set_power_mode(uint8_t mode)  
Управление режимом питания устройства  
Аргументы  
mode — Режим питания (например, POWER_SLEEP_MODE)  
Возвращает  
void  
Исключения  
Нет

---
void recvMsg(uint8_t *data, size_t len)  
Обработчик входящих сообщений через WebSerial  
Аргументы  
data — Указатель на данные сообщения  
len — Длина сообщения в байтах  
Возвращает  
void  
Исключения  
Нет

---
void triggerPowerStatus(void *parameter)  
Задача FreeRTOS для мониторинга параметров питания  
Аргументы  
parameter — Параметр задачи (не используется)  
Возвращает  
void  
Исключения  
Нет

---
void initMqtt()  
Инициализация MQTT-клиента и подключение к брокеру  
Аргументы  
— — Выполняет настройку и подключение при наличии Wi-Fi соединения  
Возвращает  
void  
Исключения  
Нет

---
void lua_init()  
Инициализация Lua-движка для выполнения пользовательских скриптов  
Аргументы  
— — Загружает и настраивает среду выполнения Lua  
Возвращает  
void  
Исключения  
Нет

---
void WebServerInit()  
Инициализация веб-сервера для обработки HTTP-запросов  
Аргументы  
— — Настраивает маршруты и обработчики веб-интерфейса  
Возвращает  
void  
Исключения  
Нет

---
void sensor_init()  
Инициализация всех подключённых датчиков (температура, уровень и др.)  
Аргументы  
— — Выполняет первоначальную настройку датчиков  
Возвращает  
void  
Исключения  
Нет

---
void samovar_reset()  
Сброс состояния устройства до начальных значений  
Аргументы  
— — Обнуляет флаги, таймеры и устанавливает базовые параметры  
Возвращает  
void  
Исключения  
Нет

---
bool check_I2C_device(uint8_t dev_type)  
Проверка наличия I2C-устройства определённого типа  
Аргументы  
dev_type — Тип ожидаемого устройства (1 — микшер, 2 — насос)  
Возвращает  
true — Устройство найдено и отвечает  
false — Устройство не обнаружено  
Исключения  
Нет

---
void get_task_stack_usage()  
Сбор и вывод информации об использовании стека задачами FreeRTOS  
Аргументы  
— — Анализирует оставшееся пространство стека для отладки  
Возвращает  
void  
Исключения  
Нет

---
void bk_proc()  
Обработка логики работы с блоком конденсации (БК)  
Аргументы  
Отсутствуют  
Возвращает  
Отсутствует  
Исключения  
Отсутствуют

---
void nbk_proc()  
Обработка логики работы с насадкой БК (НБК)  
Аргументы  
Отсутствуют  
Возвращает  
Отсутствует  
Исключения  
Отсутствуют

---
void beer_proc()  
Выполнение процесса затирания при пивоварении  
Аргументы  
Отсутствуют  
Возвращает  
Отсутствует  
Исключения  
Отсутствуют

---
void getjson(void)  
Формирует JSON-строку с текущими данными датчиков, статусов и настроек  
Аргументы  
Отсутствуют  
Возвращает  
Отсутствует  
Исключения  
Отсутствуют

---
void process_buzzer()  
Управление зуммером в зависимости от текущих оповещений  
Аргументы  
Отсутствуют  
Возвращает  
Отсутствует  
Исключения  
Отсутствуют

---
float get_temp_by_pressure(float startPressure, float baseTemp, float currentPressure)  
Рассчитывает температуру кипения при текущем атмосферном давлении  
Аргументы  
startPressure — начальное давление (калибровочное)  
baseTemp — базовая температура при калибровочном давлении  
currentPressure — текущее атмосферное давление  
Возвращает  
Рассчитанная температура кипения  
Исключения  
Отсутствуют

---
uint32_t get_stepper_speed()  
Возвращает текущую скорость шагового двигателя в шагах в секунду  
Аргументы  
Отсутствуют  
Возвращает  
Скорость в шагах в секунду  
Исключения  
Отсутствуют

---
uint32_t get_stepper_status()  
Возвращает оставшееся количество шагов до цели шагового двигателя  
Аргументы  
Отсутствуют  
Возвращает  
Оставшиеся шаги  
Исключения  
Отсутствуют

---
float i2c_get_liquid_rate_by_step(uint32_t stepsPerSecond)  
Переводит скорость шагов в расход жидкости (мл/час)  
Аргументы  
stepsPerSecond — скорость в шагах в секунду  
Возвращает  
Расход жидкости в мл/час  
Исключения  
Отсутствуют

---
float i2c_get_liquid_volume_by_step(uint32_t steps)  
Переводит количество шагов в объём жидкости (мл)  
Аргументы  
steps — количество шагов  
Возвращает  
Объём жидкости в мл  
Исключения  
Отсутствуют

---
uint32_t get_liquid_volume()  
Возвращает текущий объём перекачанной жидкости в мл  
Аргументы  
Отсутствуют  
Возвращает  
Объём в мл  
Исключения  
Отсутствуют

---
class StepperController  
Управление шаговым двигателем насоса с поддержкой позиционирования и скорости  
Поля  
targetStep — целевое положение в шагах  
currentStep — текущее положение в шагах  
speed — текущая скорость в шагах в секунду  
state — состояние (включён/выключен)  
Методы  
void setTarget(uint32_t steps) — устанавливает целевое количество шагов  
uint32_t getTarget() — возвращает целевое положение  
uint32_t getCurrent() — возвращает текущее положение  
uint32_t getSpeed() — возвращает текущую скорость  
uint8_t getState() — возвращает состояние двигателя (0=остановлен, 1=работает)

---
void build_json_status()  
Формирует JSON-строку с текущими показаниями датчиков, статусами и режимами работы устройства  
Аргументы  
Нет  
Возвращает  
Нет  
Исключения  
Нет

---
void SendMsg(const String& m, MESSAGE_TYPE msg_type)  
Отправляет текстовое сообщение указанного типа во внешние сервисы (MQTT, Telegram)  
Аргументы  
m — текст сообщения  
msg_type — тип сообщения (тревога, предупреждение, информационное)  
Возвращает  
Нет  
Исключения  
Нет

---
void WriteConsoleLog(String StringLogMsg)  
Записывает строку лога в последовательный порт и (опционально) в WebSerial, выполняя предварительную очистку спецсимволов.  
Аргументы  
StringLogMsg — Строка лога, подлежащая выводу и обработке  
Возвращает  
Нет  
Исключения  
Нет
