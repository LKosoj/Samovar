# data/edit

Модуль предоставляет веб-интерфейс для редактирования файлов на сервере с использованием Ace Editor, включая древовидную навигацию по файловой системе, контекстные действия, поддержку превью и управление HTTP-запросами через очередь. Реализует асинхронное взаимодействие с сервером для загрузки, сохранения и удаления файлов. Поддерживает определение типа файла по расширению для корректного отображения и редактирования.

Ключевые структуры данных  
QueuedRequester — Класс для управления очередью HTTP-запросов, обеспечивающий их последовательное выполнение

---
requests.add: function(method, url, params, callback)  
Добавляет HTTP-запрос в очередь на выполнение  
Аргументы  
method — HTTP-метод (GET, POST, PUT, DELETE)  
url — URL-адрес назначения  
params — Объект FormData с параметрами запроса  
callback — Функция обратного вызова, вызываемая после завершения запроса  
Возвращает  
void  
Исключения  
— Может выбросить ошибку, если XMLHttpRequest не поддерживается браузером

---
createFileUploader: function(element, tree, editor)  
Создаёт интерфейс загрузки файлов и управления файлами  
Аргументы  
element — ID DOM-элемента, в который будет вставлен интерфейс  
tree — Объект дерева файлов с методом refreshPath  
editor — Объект редактора с методом execCommand и loadUrl  
Возвращает  
void

---
createTree: function(element, editor)  
Создаёт древовидный интерфейс файловой системы с контекстным меню  
Аргументы  
element — ID DOM-элемента для размещения дерева  
editor — Объект редактора для открытия файлов  
Возвращает  
void

---
isTextFile: function(path)  
Проверяет, является ли файл текстовым по расширению  
Аргументы  
path — Путь к файлу  
Возвращает  
true, если файл имеет текстовое расширение; иначе false

---
isImageFile: function(path)  
Проверяет, является ли файл изображением по расширению  
Аргументы  
path — Путь к файлу  
Возвращает  
true, если файл имеет графическое расширение; иначе false

---
showContextMenu: function(event, path, isfile)  
Отображает контекстное меню для файла или папки  
Аргументы  
event — Событие клика мыши  
path — Путь к выбранному файлу/папке  
isfile — Флаг, указывающий, что элемент является файлом  
Возвращает  
void

---
createTreeLeaf: function(path, name, size)  
Создаёт DOM-элемент для отображения файла в дереве  
Аргументы  
path — Путь к файлу  
name — Имя файла  
size — Размер файла  
Возвращает  
DOM-элемент li, представляющий файл в дереве

---
addList: function(parent, path, items)  
Добавляет список файлов в указанный родительский элемент  
Аргументы  
parent — Родительский DOM-элемент  
path — Путь к каталогу  
items — Массив объектов файлов с полями name, type, size  
Возвращает  
void

---
httpDelete: function(filename)  
Отправляет запрос на удаление файла через очередь запросов  
Аргументы  
filename — Имя удаляемого файла  
Возвращает  
void

---
class QueuedRequester  
Очередь HTTP-запросов для последовательного выполнения операций  
Поля  
queue — Массив ожидающих запросов  
running — Флаг, указывающий, выполняется ли в данный момент запрос  
Методы  
add(method, url, params, callback) — Добавляет новый запрос в очередь

---
void httpGet(parent, path)  
Выполняет GET-запрос для получения содержимого директории по указанному пути  
Аргументы  
parent — Родительский элемент, в который будет добавлен список файлов  
path — Путь к запрашиваемой директории на сервере  
Возвращает  
void

---
object createEditor(element, file, lang, theme, type)  
Инициализирует и настраивает редактор Ace с поддержкой автодополнения, сохранения и изменения языка  
Аргументы  
element — DOM-элемент или его ID, в котором будет размещён редактор  
file — Путь к файлу, который следует открыть (опционально)  
lang — Язык программирования для подсветки синтаксиса (опционально, определяется по расширению)  
theme — Тема оформления редактора (по умолчанию — "textmate")  
type — MIME-тип содержимого (используется при сохранении)  
Возвращает  
Настроенный экземпляр Ace Editor с расширенными командами и обработчиками

---
void onBodyLoad()  
Инициализирует редактор и дерево файлов при загрузке страницы, используя параметры из URL  
Аргументы  
—  
Возвращает  
void

---
string getLangFromFilename(filename)  
Определяет язык программирования по расширению файла для подсветки синтаксиса  
Аргументы  
filename — Имя файла, из которого извлекается расширение  
Возвращает  
Строка с идентификатором языка, поддерживаемого Ace Editor (например, "javascript", "html", "c_cpp")

---
void httpPost(filename, data, type)  
Отправляет содержимое файла на сервер методом POST  
Аргументы  
filename — Имя файла, который сохраняется  
data — Содержимое файла в виде строки  
type — MIME-тип данных, передаваемых в теле запроса  
Возвращает  
void

---
void httpGetProcessRequest(status, responseText)  
Обрабатывает ответ сервера на GET-запрос: загружает содержимое файла в редактор  
Аргументы  
status — HTTP-статус ответа  
responseText — Тело ответа с содержимым файла  
Возвращает  
void

---
void httpPostProcessRequest(status, responseText)  
Обрабатывает результат отправки файла: выводит сообщение об ошибке при неудаче  
Аргументы  
status — HTTP-статус ответа  
responseText — Сообщение об ошибке или успехе  
Возвращает  
void
