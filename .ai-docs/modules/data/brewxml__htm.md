# data/brewxml

Модуль обработки пивоваренных рецептов в формате BeerXML и генерации управляющих программ для оборудования.  
Реализует логику загрузки, парсинга и обработки пивоваренных рецептов в формате BeerXML. Извлекает данные о затирании, кипячении и брожении, формирует последовательность температурных шагов и генерирует управляющую программу для оборудования (например, пивоварни "Самовар"). Результат представляет собой текстовый скрипт, соответствующий протоколу управления устройством.

Ключевые структуры данных  
recipe — Объект, содержащий нормализованные данные пивоваренного рецепта, включая этапы затирания, кипячения, ингредиенты и объём

function decimalAdjust(type, value, exp)  
Корректирует округление десятичных дробей с учётом степени.  
Аргументы  
type — Тип операции: "round", "ceil", "floor"  
value — Число для корректировки  
exp — Показатель степени (десятичный логарифм основания корректировки)  
Возвращает  
Скорректированное число  
Исключения  
Не выбрасывает исключения

---
function compare(a, b)  
Сравнивает два объекта по значению времени в поле TIME.  
Аргументы  
a — Первый объект для сравнения  
b — Второй объект для сравнения  
Возвращает  
1, если a.TIME < b.TIME; -1, если a.TIME > b.TIME; 0, если равны  
Исключения  
Не выбрасывает исключения

---
function loadBeerXML(file)  
Загружает и определяет формат XML-файла рецепта (BeerXML или BrewMate).  
Аргументы  
file — Объект File, выбранный пользователем  
Возвращает  
void  
Исключения  
Выбрасывает ошибку при невозможности чтения файла или определения формата

---
function parseXml(xml, arrayTags)  
Преобразует XML-строку в объект JavaScript с использованием DOMParser.  
Аргументы  
xml — XML-строка для парсинга  
arrayTags — Массив имён тегов, которые должны быть преобразованы в массивы  
Возвращает  
Объект, представляющий XML-структуру  
Исключения  
Выбрасывает ошибку при невозможности парсинга XML

---
function isArray(myArray)  
Проверяет, является ли объект итерируемым (массивом или подобным).  
Аргументы  
myArray — Объект для проверки  
Возвращает  
true, если объект итерируемый; иначе false  
Исключения  
Не выбрасывает исключения

---
function isNumeric(str)  
Проверяет, является ли строка числовым значением.  
Аргументы  
str — Строка для проверки  
Возвращает  
true, если строка представляет число; иначе false  
Исключения  
Не выбрасывает исключения

---
function get_object_value(Obj, str, exp)  
Извлекает значение из объекта, форматирует его и добавляет суффикс.  
Аргументы  
Obj — Объект, содержащий поле #text  
str — Суффикс, добавляемый к значению (по умолчанию пусто)  
exp — Точность округления (по умолчанию -2)  
Возвращает  
Форматированная строка или "Нет в рецепте"  
Исключения  
Не выбрасывает исключения

---
function check_value(val, type)  
Возвращает значение по умолчанию, если передано "Нет в рецепте".  
Аргументы  
val — Проверяемое значение  
type — Тип значения: "bt" — время варки, "pt" — время затирания  
Возвращает  
Переданное значение или значение по умолчанию  
Исключения  
Не выбрасывает исключения

---
function get_brew_info(xml)  
Обрабатывает данные BeerXML и извлекает информацию о рецепте.  
Аргументы  
xml — Объект, полученный после парсинга BeerXML  
Возвращает  
void  
Исключения  
Не выбрасывает исключения

---
function get_brewmate_info(xml)  
Обрабатывает данные BrewMate и преобразует их в стандартный формат.  
Аргументы  
xml — Объект, полученный после парсинга BrewMate XML  
Возвращает  
void  
Исключения  
Не выбрасывает исключения

---
function processRecipe(recipe)  
Генерирует управляющую программу на основе текущего рецепта.  
Аргументы  
recipe — Объект рецепта с нормализованными данными  
Возвращает  
void  
Исключения  
Не выбрасывает исключения

---
function get_recipe(recipe)  
Отображает информацию о рецепте в пользовательском интерфейсе.  
Аргументы  
recipe — Объект рецепта с нормализованными данными  
Возвращает  
void  
Исключения  
Не выбрасывает исключения

---
function set_program()  
Отправляет сгенерированную программу на сервер и обновляет интерфейс.  
Аргументы  
Нет аргументов  
Возвращает  
void  
Исключения  
Показывает alert при ошибках отправки или отсутствия программы

---
class XMLHttpRequest  
Представляет объект для выполнения HTTP-запросов к серверу  
Поля  
onreadystatechange — Обработчик изменения состояния запроса  
Методы  
open(method, url, async) — Инициализирует HTTP-запрос  
send(data) — Отправляет запрос на сервер
