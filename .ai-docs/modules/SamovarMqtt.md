# SamovarMqtt

/**
 * @brief Модуль управления MQTT-клиентом для устройства Samovar.
 *
 * Обеспечивает подключение к MQTT-брокеру, публикацию сообщений и обработку событий соединения.
 * Используется для удалённой передачи данных и уведомлений. Аутентификация выполняется по логину и паролю.
 * Отправка сообщений возможна только при наличии валидного Blynk-токена.
 *
 * Ключевые структуры данных
 * mqttstr — префикс топика по умолчанию для устройства ("SMV/")
 * mqttstr1 — буфер для формирования полного топика при отправке сообщений
 * mqttUser — логин для аутентификации на MQTT-брокере
 * mqttPassword — пароль для аутентификации на MQTT-брокере
 * mqttClient — экземпляр асинхронного MQTT-клиента
 */

void initMqtt()
Инициализирует MQTT-клиента с параметрами подключения и начинает подключение к брокеру.
Аргументы
Возвращает
Нет возвращаемого значения
Исключения

---
void connectToMqtt()
Выполняет попытку подключения к MQTT-брокеру.
Аргументы
Нет аргументов
Возвращает
Нет возвращаемого значения
Исключения

---
void onMqttConnect(bool sessionPresent)
Обработчик события успешного подключения к MQTT-брокеру.
Аргументы
sessionPresent — флаг, указывающий, существует ли активная сессия
Возвращает
Нет возвращаемого значения
Исключения

---
void onMqttDisconnect(AsyncMqttClientDisconnectReason reason)
Обработчик события разрыва соединения с MQTT-брокером.
Аргументы
reason — причина отключения, определённая в AsyncMqttClientDisconnectReason
Возвращает
Нет возвращаемого значения
Исключения

---
void onMqttPublish(uint16_t packetId)
Обработчик подтверждения публикации сообщения от MQTT-брокера.
Аргументы
packetId — идентификатор пакета, для которого получено подтверждение
Возвращает
Нет возвращаемого значения
Исключения

---
void MqttSendMsg(const String &Str, const char *chart, int version)
Отправляет строковое сообщение через MQTT с указанием типа и версии.
Аргументы
Str — текст сообщения, которое будет отправлено
chart — подстрока топика, определяющая категорию сообщения
version — версия формата сообщения (используется в топике)
Возвращает
Нет возвращаемого значения
Исключения

---
void SendMsg(const String& m, MESSAGE_TYPE msg_type)
Отправляет сообщение в систему уведомлений (через MQTT или другие каналы).
Аргументы
m — текст сообщения
msg_type — тип сообщения (например, уведомление или тревога)
Возвращает
Нет возвращаемого значения
Исключения
