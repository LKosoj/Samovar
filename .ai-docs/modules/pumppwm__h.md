# pumppwm

Модуль управления водяным насосом для системы Samovar, реализующий PID-регулирование скорости насоса в зависимости от температуры.  
Использует библиотеку GyverPID для формирования управляющего сигнала и ESP32PWM для генерации ШИМ-сигнала на выводе насоса.  
Работа модуля активируется при определении макроса `USE_WATER_PUMP`.  
Обеспечивает плавный запуск, ограничение минимальной и максимальной скорости, а также реакцию на аварийные события.

Ключевые структуры данных  
pump_regulator — PID-регулятор, управляющий скоростью насоса на основе текущей температуры  
pump_pwm — объект для управления ШИМ-сигналом на выводе насоса

void init_pump_pwm(uint8_t pin, int freq)  
Инициализирует ШИМ для насоса и настраивает параметры PID-регулятора  
Аргументы  
pin — номер GPIO-пина, к которому подключён насос  
freq — частота ШИМ-сигнала в Гц  
Возвращает  
Нет  
Исключения  
Нет  
---  
void set_pump_pwm(float duty)  
Устанавливает скважность ШИМ для насоса с учётом состояния запуска и аварий  
Аргументы  
duty — желаемое значение ШИМ (0–1023)  
Возвращает  
Нет  
Исключения  
Нет  
---  
void set_pump_speed_pid(float temp)  
Обновляет входное значение PID-регулятора и устанавливает соответствующую скорость насоса  
Аргументы  
temp — текущее значение температуры (в градусах Цельсия)  
Возвращает  
Нет  
Исключения  
Нет
