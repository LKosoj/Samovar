<html>
<head>
<meta charset='utf-8'>
<meta http-equiv="Cache-Control" content="no-cache">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" href="style.css">
<title>–°–∞–º–æ–≤–∞—Ä - –ü—Ä–æ–≥—Ä–∞–º–º–∞</title>

<script>
  var pwr_unit = "%pwr_unit%"; 
  var _lnIdx = 0;
  var phv = 0;
  var ptv = 0;
  var pbas = 0;
  var programerr = false;
  var glcalcnum = false;

  // ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ö–û–õ–û–ù–ù–´ (–∏–∑ NVS) ==========
  var columnConfig = {
    diameterInch: parseFloat("%ColDiam%"),
    heightM: parseFloat("%ColHeight%"),
    packingDensity: parseInt("%PackDens%"),
    calculatedParams: null
  };

  // –ó–∞–ø—Ä–æ—Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–ª–æ–Ω–Ω—ã —Å –±—ç–∫–µ–Ω–¥–∞
  function updateColumnParams() {
    const matSelect = document.getElementById("loadprogram");
    if (!matSelect) return;
    const mat = matSelect.value;
    
    fetch("/ajax_col_params?mat=" + mat)
      .then(r => r.json())
      .then(data => {
        columnConfig.calculatedParams = data;
        displayColumnParams();
      })
      .catch(err => console.error("–û—à–∏–±–∫–∞ API –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–ª–æ–Ω–Ω—ã:", err));
  }

  // –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤, –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –æ—Ç –±—ç–∫–µ–Ω–¥–∞
  function displayColumnParams() {
    const p = columnConfig.calculatedParams;
    if (!p) return;
    
    const resultsBlock = document.getElementById('columnParamsResults');
    if (!resultsBlock) return;

    // –ú–æ—â–Ω–æ—Å—Ç—å –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
    document.getElementById('colFloodPower').textContent = p.floodPowerW.toFixed(0);
    document.getElementById('colWorkingPower').textContent = p.workingPowerW.toFixed(0);
    document.getElementById('colMaxFlow').textContent = p.maxFlowMlH.toFixed(0);
    document.getElementById('colTheoreticalPlates').textContent = p.theoreticalPlates.toFixed(1);
    
    // –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–ª/—á)
    document.getElementById('colHeadsSpeed').textContent = (p.headsFlowMlH / 1000).toFixed(3);
    document.getElementById('colBodySpeedMin').textContent = (p.bodyFlowMinMlH / 1000).toFixed(3);
    document.getElementById('colBodySpeedMax').textContent = (p.bodyFlowMaxMlH / 1000).toFixed(3);
    
    const heaterMaxPwr = parseFloat(document.getElementById('heaterMaxPower').value) || 3500;
    const pUnit = (pwr_unit === 'V') ? ' –í' : ' –í—Ç';
    
    let tailsPwr = p.tailsPowerW;
    let bodyEndPwr = p.bodyEndPowerW;
    let workingPwr = p.workingPowerW;
    let floodPwr = p.floodPowerW;
    
    if (pwr_unit === 'V') {
      tailsPwr = Math.round(220 * Math.sqrt(p.tailsPowerW / heaterMaxPwr));
      bodyEndPwr = Math.round(220 * Math.sqrt(p.bodyEndPowerW / heaterMaxPwr));
      workingPwr = Math.round(220 * Math.sqrt(p.workingPowerW / heaterMaxPwr));
      floodPwr = Math.round(220 * Math.sqrt(p.floodPowerW / heaterMaxPwr));
      
      document.getElementById('colFloodPower').textContent = floodPwr;
      document.getElementById('colWorkingPower').textContent = workingPwr;
      // –û–±–Ω–æ–≤–ª—è–µ–º –µ–¥–∏–Ω–∏—Ü—ã –∏–∑–º–µ—Ä–µ–Ω–∏—è
      document.getElementById('floodUnit').textContent = ' –í';
      document.getElementById('workingUnit').textContent = ' –í';
    } else {
      document.getElementById('floodUnit').textContent = ' –í—Ç';
      document.getElementById('workingUnit').textContent = ' –í—Ç';
    }

    document.getElementById('colTailsSpeed').textContent = (p.tailsFlowMlH / 1000).toFixed(3) + ' (–ø—Ä–∏ ' + tailsPwr + pUnit + ')';

    // –ò–Ω—Ñ–æ –ø—Ä–æ –∫–æ–Ω–µ—Ü —Ç–µ–ª–∞
    const bodyInfo = document.getElementById('colBodySpeedMax').parentNode;
    if (bodyInfo) {
      let endBodyNote = bodyInfo.querySelector('.body-end-note');
      if (!endBodyNote) {
        endBodyNote = document.createElement('div');
        endBodyNote.className = 'body-end-note';
        endBodyNote.style.fontSize = '0.85em';
        endBodyNote.style.marginTop = '4px';
        endBodyNote.style.color = '#666';
        bodyInfo.appendChild(endBodyNote);
      }
      endBodyNote.innerHTML = 'üëâ –ö–æ–Ω–µ—Ü —Ç–µ–ª–∞ (<15% ABV): <b>' + (p.bodyEndFlowMlH / 1000).toFixed(3) + '</b> –ª/—á (–ø—Ä–∏ <b>' + bodyEndPwr + pUnit + '</b>)';
    }

    // –¢–µ–∫—Å—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
    const strategyNote = document.getElementById('strategyNote');
    if (strategyNote) {
      const mat = parseInt(document.getElementById("loadprogram").value);
      if (mat === 0) {
        strategyNote.innerHTML = 'üçé <b>–°—Ç—Ä–∞—Ç–µ–≥–∏—è "–§—Ä—É–∫—Ç—ã":</b> –ü–ª—ë–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º (–Ω–∏–∑–∫–æ–µ –§–ß) –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä–æ–º–∞—Ç–∞.';
        strategyNote.style.color = '#e67e22';
      } else if (mat === 1) {
        strategyNote.innerHTML = 'üåæ <b>–°—Ç—Ä–∞—Ç–µ–≥–∏—è "–ó–µ—Ä–Ω–æ":</b> –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –æ—á–∏—Å—Ç–∫–æ–π –∏ –≤–∫—É—Å–æ–º.';
        strategyNote.style.color = '#d35400';
      } else {
        strategyNote.innerHTML = 'üíé <b>–°—Ç—Ä–∞—Ç–µ–≥–∏—è "–°–∞—Ö–∞—Ä":</b> –†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤—ã—Å–æ–∫–æ–µ –§–ß) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —á–∏—Å—Ç–æ—Ç—ã.';
        strategyNote.style.color = '#2980b9';
      }
    }
    
    resultsBlock.style.display = 'block';
  }

  // –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Å–∫–æ—Ä–æ—Å—Ç–µ–π –∏ –º–æ—â–Ω–æ—Å—Ç–∏ –∫ —Ç–∞–±–ª–∏—Ü–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã
  function applyRecommendedSpeeds() {
    const p = columnConfig.calculatedParams;
    if (!p) {
      alert('–°–Ω–∞—á–∞–ª–∞ –¥–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≥—Ä—É–∑–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–ª–æ–Ω–Ω—ã');
      return;
    }
    
    const programLines = document.getElementById('prg').childNodes;
    let appliedCount = 0;
    
    // –ü–æ–∏—Å–∫ —Å—Ç—Ä–æ–∫ —Ç–µ–ª–∞ –¥–ª—è –ø–ª–∞–≤–Ω–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏
    let bodyLineIndices = [];
    for (let i = 1; i < programLines.length; i++) {
      const line = programLines[i];
      if (!line || !line.childNodes) continue;
      const typeSelect = line.querySelector('select[name^="ptype"]');
      if (typeSelect && (typeSelect.value === 'B' || typeSelect.value === 'C')) {
        bodyLineIndices.push(i);
      }
    }
    
    for (let i = 1; i < programLines.length; i++) {
      const line = programLines[i];
      if (!line || !line.childNodes) continue;
      
      const typeSelect = line.querySelector('select[name^="ptype"]');
      const speedInput = line.querySelector('input[name^="speed"]');
      const powerInput = line.querySelector('input[name^="pvolt"]');
      
      if (!typeSelect || !speedInput) continue;
      
      const type = typeSelect.value;
      let recommendedSpeed = 0;
      let recommendedPower = 0;
      
      switch(type) {
        case 'H':
          recommendedSpeed = p.headsFlowMlH;
          recommendedPower = p.headsPowerW;
          break;
        case 'B':
        case 'C':
          if (bodyLineIndices.length > 1) {
            const bodyIdx = bodyLineIndices.indexOf(i);
            const t = bodyIdx / (bodyLineIndices.length - 1);
            recommendedSpeed = p.bodyFlowMaxMlH - (p.bodyFlowMaxMlH - p.bodyEndFlowMlH) * t;
            recommendedPower = (type === 'C') ? p.floodPowerW : (p.workingPowerW + (p.bodyEndPowerW - p.workingPowerW) * t);
          } else {
            recommendedSpeed = p.bodyFlowMaxMlH;
            recommendedPower = (type === 'C') ? p.floodPowerW : p.workingPowerW;
          }
          break;
        case 'T':
          recommendedSpeed = p.tailsFlowMlH;
          recommendedPower = p.tailsPowerW;
          break;
      }
      
      if (recommendedSpeed > 0) {
        speedInput.value = (recommendedSpeed / 1000).toFixed(3);
        if (powerInput && recommendedPower > 0) {
          if (pwr_unit === 'V') {
            const heaterMaxPwr = parseFloat(document.getElementById('heaterMaxPower').value) || 3500; 
            powerInput.value = Math.round(220 * Math.sqrt(recommendedPower / heaterMaxPwr));
          } else {
            powerInput.value = Math.round(recommendedPower);
          }
        }
        appliedCount++;
      }
    }
    
    set_num();
    if (appliedCount > 0) alert('‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ ' + appliedCount + ' —Å—Ç—Ä–æ–∫–∞–º');
  }

  function loadFile(e) {
    var file = e;
    var reader = new FileReader();
    reader.onload = function () {
      document.getElementById('WProgram1').value = reader.result;
      glcalcnum = false;
      calc_program();
    };
    reader.readAsText(file, "UTF-8");
  }

  function getProgramFromFile(selectObject){
    var value = selectObject.value;
    var fn = (value == 0) ? 'program_fruit.txt' : (value == 1 ? 'program_grain.txt' : 'program_shugar.txt');
    
    updateColumnParams(); 
    
    fetch(fn)
      .then(response => response.text())
      .then((data) => {
        document.getElementById('WProgram1').value = data;
        glcalcnum = false;
        calc_program();
      });
  }

  function SaveProgramToFile() {
    var filename = 'programbackup.txt';
    var text = document.getElementById('WProgram1').value;
    var pom = document.createElement('a');
    pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
    pom.setAttribute('download', filename);
    pom.style.display = 'none';
    document.body.appendChild(pom);
    pom.click();
    document.body.removeChild(pom);
  }

  function check_program(str){
    var arrayOfStrings = str.split("\n");
    var prevcnt = 0;
    var ret = true;
    for (i = 0; i < arrayOfStrings.length; i++){
      var arrayOfDelim = arrayOfStrings[i].split(";");
      if (arrayOfDelim.length > 1 && prevcnt > 0 && prevcnt != arrayOfDelim.length) ret = false;
      prevcnt = arrayOfDelim.length;
    }
    return ret;
  }

  function get_time(tm){
    var h = Math.trunc(tm);
    var m = Math.trunc((tm - h) * 60);
    return (h < 10 ? "0" + h : h) + ":" + (m < 10 ? "0" + m : m);
  }

  function set_num(){
    prep_calc();
    programerr = false;
    var e = document.getElementById("prg").childNodes;
    var sum = 0; var sumh = 0; var sumb = 0;
    var prgc = ""; var prgo = "";
    
    for (i=1;i<e.length;i++){
      var row = e[i];
      row.childNodes[0].innerText = (i < 10 ? "0" : "") + i;
      
      row.childNodes[2].value = row.childNodes[2].value.replace(",",".");
      row.childNodes[5].value = row.childNodes[5].value.replace(",",".");
      
      var capacityNum = document.getElementById("pnum" + (i-1)).value;
      var type = row.childNodes[4].value;
      var vlc = 1;
      
      if (type == "H") { vlc = phv / 100; sumh += Number(row.childNodes[3].value); }
      else if (type == "T") { vlc = ptv / 100; }
      else if (type == "B" || type == "C") { vlc = pbas / 100; sumb += Number(row.childNodes[3].value); }
      
      var volume = (row.childNodes[3].value * vlc);
      row.childNodes[6].value = volume.toFixed(3);
      
      var time = (type == "P") ? (row.childNodes[2].value / 3600) : (volume / row.childNodes[2].value);
      row.childNodes[7].value = get_time(time);
      sum += time;
      
      prgc += type + ";" + (type == "P" ? row.childNodes[2].value : volume * 1000) + ";" + row.childNodes[2].value + ";" + capacityNum + ";0;" + row.childNodes[5].value + "\n";
      prgo += capacityNum + ";" + row.childNodes[2].value + ";" + row.childNodes[3].value + ";" + type + ";" + row.childNodes[5].value + "\n";
    }
    
    document.getElementById("sum").value = get_time(sum);
    document.getElementById("WProgram1").value = prgo.trim();
    document.getElementById("WProgram").value = prgc.trim();
    
    if (sumh != 100 || sumb != 100) programerr = true;
    return programerr;
  }

  function prep_calc(){
    var vless = document.getElementById('vless').value;
    var vlssp = document.getElementById('vlssp').value / 100;
    var vlp = document.getElementById('vlp').value / 100;
    var vlhp = document.getElementById('vlhp').value / 100;
    var vltp = document.getElementById('vltp').value / 100;
    
    var tas = vless * vlssp;
    phv = (tas * vlhp) / vlp;
    ptv = (tas * vltp) / vlp * 2;
    pbas = (tas - (tas * vlhp) - (tas * vltp)) / vlp;
    
    document.getElementById('trest').value = ((vless - phv - pbas) * 0.9).toFixed(2);
  }

  function calc_program(){
    prep_calc();
    let pwrLabel = (pwr_unit == 'P' ? '–ú–æ—â–Ω' : '–ù–∞–ø—Ä');
    var e = document.getElementById("prg");
    e.innerHTML = `<div class="flex_row" style="font-size:18px; margin: 0.5em 0;" id="hdr">
      &nbsp;&nbsp;‚Ññ&nbsp;&nbsp;–Å–º–∫–æ—Å—Ç—å&nbsp;–°–∫–æ—Ä–æ—Å—Ç—å&nbsp;–ü—Ä–æ—Ü–µ–Ω—Ç&nbsp;&nbsp;&nbsp;–¢–∏–ø&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;${pwrLabel}&nbsp;&nbsp;&nbsp;&nbsp;–í—ã—Ö–æ–¥&nbsp;&nbsp;–í—Ä–µ–º—è</div>`;
    
    var arr = document.getElementById("WProgram1").value.split("\n");
    _lnIdx = 0;
    for (var z=0; z<arr.length; z++) if(arr[z].trim()) addLine(false, arr[z]);
    glcalcnum = true;
    set_num();
  }

  function set_program(){
    if (set_num()) { alert("–û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ (–≥–æ–ª–æ–≤/—Ç–µ–ª–∞ –Ω–µ 100%)!"); return; }
    var request = new XMLHttpRequest();
    request.open('POST', '/program', false);
    request.send(new FormData(document.forms.mainform));
    if(request.status == 200) alert("–ü—Ä–æ–≥—Ä–∞–º–º–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!");
    else alert("–û—à–∏–±–∫–∞: " + request.status);
  }

  function addLine(obj, s){
    var arr = s ? s.split(";") : ["0","1.0","100","B","0"];
    var dl = document.createElement("div");
    dl.className = "prgline"; dl.id = "prgln" + _lnIdx;
    
    dl.innerHTML = `<label class="prglabel"></label>
      <select id="pnum${_lnIdx}" name="pnum${_lnIdx}">${[0,1,2,3,4,5,6,7,8,9,10].map(n => `<option value="${n}">${n}</option>`).join('')}</select>
      <input type="text" name="speed${_lnIdx}" value="${arr[1]}" onchange="set_num()">
      <input type="text" name="percent${_lnIdx}" value="${arr[2]}" onchange="set_num()">
      <select id="ptype${_lnIdx}" name="ptype${_lnIdx}" onchange="set_bgcolor(${_lnIdx})">
        <option value="H">–ì–æ–ª–æ–≤—ã</option><option value="B">–¢–µ–ª–æ</option><option value="C">–ü—Ä–µ–¥–∑–∞—Ö–ª–µ–±</option><option value="T">–•–≤–æ—Å—Ç—ã</option><option value="P">–ü–∞—É–∑–∞</option>
      </select>
      <input type="text" name="pvolt${_lnIdx}" value="${arr[4]}" onchange="set_num()">
      <input type="text" name="pvl${_lnIdx}" disabled>
      <input type="text" name="tm${_lnIdx}" disabled>
      <img src="plus.png" width="20" onclick="addLine('prgln${_lnIdx}','')">
      <img src="minus.png" width="20" onclick="removeLine('prgln${_lnIdx}')">`;
    
    if (!obj) document.getElementById("prg").appendChild(dl);
    else document.getElementById(obj).after(dl);
    
    document.getElementById("ptype" + _lnIdx).value = arr[3] || "B";
    document.getElementById("pnum" + _lnIdx).value = arr[0] || "0";
    set_bgcolor(_lnIdx);
    _lnIdx++;
    if (!s) set_num();
  }

  function removeLine(ln){
    if (document.getElementById("prg").childNodes.length <= 2) return;
    document.getElementById(ln).remove();
    set_num();
  }

  function set_bgcolor(idx){
    var type = document.getElementById("ptype" + idx).value;
    var colors = {H:"#80FFFA", B:"#32CD3229", C:"#FFFF0039", P:"#C4C4C4", T:"#8B451334"};
    document.getElementById("prgln" + idx).style.backgroundColor = colors[type];
    set_num();
  }

  window.onload = function() {
    updateColumnParams();
    getProgramFromFile(document.getElementById("loadprogram"));
  };
</script>
</head>
<body>
<form action='none' onsubmit='return false' name="mainform" id="mainform">
<h1>Samovar v. %v%</h1>
<div class="text">–†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç–±–æ—Ä–∞
<select id="loadprogram" name="loadprogram" onchange="getProgramFromFile(this)">
  <option value="0">–§—Ä—É–∫—Ç—ã</option>
  <option value="1">–ó–µ—Ä–Ω–æ</option>
  <option value="2">–°–∞—Ö–∞—Ä</option>
</select>
</div>

<!-- –ë–õ–û–ö –ü–ê–†–ê–ú–ï–¢–†–û–í –ö–û–õ–û–ù–ù–´ (–¢–û–õ–¨–ö–û –ü–†–û–°–ú–û–¢–†) -->
<div class="tabcontent" style="display: block; border-top: 1px solid #ccc; padding: 10px;">
  <div style="border: 2px solid #3498db; background: #fafafa; padding: 15px; border-radius: 5px;">
    <div style="color: #3498db; font-weight: bold; margin-bottom: 10px;">‚öôÔ∏è –ü–ê–†–ê–ú–ï–¢–†–´ –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø (–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫)</div>
    <div style="font-size: 0.9em; margin-bottom: 10px; color: #666;">
      –î–∏–∞–º–µ—Ç—Ä: <b>%ColDiam% –¥—é–π–º.</b> | –í—ã—Å–æ—Ç–∞: <b>%ColHeight% –º</b> | –ù–∞—Å–∞–¥–∫–∞: <b>%PackDens%%</b>
      <br><small><i>–ò–∑–º–µ–Ω–∏—Ç—å –º–æ–∂–Ω–æ –≤ –º–µ–Ω—é "–ù–∞—Å—Ç—Ä–æ–π–∫–∏"</i></small>
    </div>
    
    <!-- –°–∫—Ä—ã—Ç–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ—â–Ω–æ—Å—Ç–∏ –¢–≠–ù–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤–æ–ª—å—Ç -->
    <div id="heaterPowerBlock" style="display: %pwr_unit_v_only%; margin-bottom: 10px;">
      –ú–æ—â–Ω–æ—Å—Ç—å –¢–≠–ù–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞: <input type="text" id="heaterMaxPower" value="3500" style="width: 50px;"> –í—Ç
    </div>

    <div id="columnParamsResults" style="display: none; background: #fff; border: 1px solid #3498db; padding: 10px; border-radius: 4px;">
      <div style="display: flex; justify-content: space-between; margin-bottom: 10px; border-bottom: 1px dashed #ccc; padding-bottom: 5px;">
        <span>–ó–∞—Ö–ª—ë–±: <b id="colFloodPower">-</b><span id="floodUnit"> –í—Ç</span></span>
        <span>–†–∞–±–æ—á–∞—è: <b id="colWorkingPower">-</b><span id="workingUnit"> –í—Ç</span></span>
        <span>–¢–∞—Ä–µ–ª–æ–∫: <b id="colTheoreticalPlates">-</b></span>
      </div>
      <div style="margin-bottom: 10px;">
        –ì–æ–ª–æ–≤—ã: <b id="colHeadsSpeed">-</b> –ª/—á | –¢–µ–ª–æ: <b id="colBodySpeedMin">-</b>...<b id="colBodySpeedMax">-</b> –ª/—á | –•–≤–æ—Å—Ç—ã: <b id="colTailsSpeed">-</b> –ª/—á
      </div>
      <div id="strategyNote" style="font-size: 0.85em; margin-bottom: 10px; padding: 5px; background: #eee;"></div>
      <input type="button" class="button" value="–ü–†–ò–ú–ï–ù–ò–¢–¨ –ö –ü–†–û–ì–†–ê–ú–ú–ï" onclick="applyRecommendedSpeeds()" style="width: 100%; background: #3498db; color: white;">
    </div>
  </div>
</div>

<div class="tabcontent" style="display: block; border-top: 1px solid #ccc;">
  <div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em; padding: 10px;">
    –û–±—ä–µ–º –°–°: <input id='vless' type='text' value='12.25' style="width:50px" onchange="set_num()"> –ª |
    % –ê–°: <input id='vlssp' type='text' value='34' style="width:40px" onchange="set_num()"> % |
    –í—ã—Ö–æ–¥: <input id='vlp' type='text' value='94' style="width:40px" onchange="set_num()"> %
    <br>
    –ì–æ–ª–æ–≤—ã: <input id='vlhp' type='text' value='8' style="width:40px" onchange="set_num()"> % |
    –•–≤–æ—Å—Ç—ã: <input id='vltp' type='text' value='5' style="width:40px" onchange="set_num()"> % |
    –û—Å—Ç–∞—Ç–æ–∫: <input id='trest' type='text' value='0' style="width:50px" disabled> –ª
  </div>

  <div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em;">
    <div class="prg" id="prg"></div>
  </div>

  <div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em; padding: 5px;">
    –ò—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è: <input id='sum' type='text' value='' disabled style="width:100px">
  </div>

  <div style="text-align: center;">
    <input type="button" value="–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç" onclick="SaveProgramToFile()" class="button">
    <label for="fileToLoad" class="button">–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞—Å—á–µ—Ç</label>
    <input type="file" id="fileToLoad" style="display:none" onchange="loadFile(this.files[0])">
    <br><br>
    <input type="button" value="–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É" onclick="set_program()" class="button" style="background:#27ae60; color:white">
    <input type="button" value="–ù–∞ –≥–ª–∞–≤–Ω—É—é" onclick="location.href='index.htm'" class="button">
  </div>
</div>

<textarea id='WProgram1' style="display:none"></textarea>
<textarea id='WProgram' name='WProgram' style="display:none">%WProgram%</textarea>
</form>
</body>
</html>
