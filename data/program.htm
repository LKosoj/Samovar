<html>
<head>
<meta charset='utf-8'>
<meta http-equiv="Cache-Control" content="no-cache">
<link rel="shortcut icon" href="favicon.ico" type="image/x-icon"/>
<link rel="stylesheet" href="style.css">
<title>–°–∞–º–æ–≤–∞—Ä</title>

<script>
  var pwr_unit = "%pwr_unit%"; 
var _lnIdx = 0;
var phv = 0;
var ptv = 0;
var pbas = 0;
var programerr;
var glcalcnum = false;

// ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø –ö–û–õ–û–ù–ù–´ ==========
var columnConfig = {
  diameterInch: 2.0,
  heightM: 0.5,
  packingDensity: 80,
  rawMaterial: 0,
  calculatedParams: null
};

// –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ —Ç–∏–ø–æ–≤ —Å—ã—Ä—å—è (—Ç–∞–±–ª–∏—Ü–∞ 8.4 –∏–∑ —Ä–µ—Ñ–µ—Ä–µ–Ω—Å–æ–≤)
var rawMaterialData = {
  "0": {
    name: "–§—Ä—É–∫—Ç—ã",
    headsPercent: 5,
    tailsPercent: 5,
    frMultiplier: 0.85,
    aromaPreservation: 0.9,
    recommendedHeadsSpeed: 0.08,
    recommendedBodySpeedMin: 0.20,
    recommendedBodySpeedMax: 0.60
  },
  "1": {
    name: "–ó–µ—Ä–Ω–æ",
    headsPercent: 6,
    tailsPercent: 5,
    frMultiplier: 1.0,
    aromaPreservation: 0.7,
    recommendedHeadsSpeed: 0.07,
    recommendedBodySpeedMin: 0.25,
    recommendedBodySpeedMax: 0.55
  },
  "2": {
    name: "–°–∞—Ö–∞—Ä",
    headsPercent: 4,
    tailsPercent: 5,
    frMultiplier: 1.2,
    aromaPreservation: 0.3,
    recommendedHeadsSpeed: 0.05,
    recommendedBodySpeedMin: 0.15,
    recommendedBodySpeedMax: 0.40
  }
};

// –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –Ω–∞—Å–∞–¥–æ–∫
var packingData = {
  hetpBase: 30,
  densityImpact: 0.3
};

// –î–µ–ª–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã–º–∏ –≥–ª–æ–±–∞–ª—å–Ω–æ —á–µ—Ä–µ–∑ window
window.columnConfig = window.columnConfig || columnConfig;
window.rawMaterialData = window.rawMaterialData || rawMaterialData;
window.packingData = window.packingData || packingData;

// –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–∑–∞—â–∏—â—ë–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)
function initColumnVariables() {
  if (!window.packingData) window.packingData = packingData;
  if (!window.columnConfig) window.columnConfig = columnConfig;
  if (!window.rawMaterialData) window.rawMaterialData = rawMaterialData;
  return true;
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–∞–∑—É
initColumnVariables();

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤ –≥–æ–ª–æ–≤ –∏ —Ö–≤–æ—Å—Ç–æ–≤ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ç–∏–ø–∞ —Å—ã—Ä—å—è
function updateHeadsTailsPercent() {
  const materialSelect = document.getElementById('loadprogram');
  const headsInput = document.getElementById('vlhp');
  const tailsInput = document.getElementById('vltp');
  
  if (!materialSelect || !headsInput || !tailsInput) {
    return; // –≠–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
  }
  
  const rawMaterialType = parseInt(materialSelect.value) || 0;
  const rawData = window.rawMaterialData ? window.rawMaterialData[rawMaterialType] : null;
  
  if (rawData && rawData.headsPercent !== undefined) {
    headsInput.value = rawData.headsPercent;
  }
  
  if (rawData && rawData.tailsPercent !== undefined) {
    tailsInput.value = rawData.tailsPercent;
  }
  
  // –í—ã–∑—ã–≤–∞–µ–º set_num() –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –µ—Å–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  if (typeof set_num === 'function') {
    set_num();
  }
}

// –†–∞—Å—á—ë—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∫–æ–ª–æ–Ω–Ω—ã
function calculateColumnParams() {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
  if (typeof initColumnVariables === 'function') {
    initColumnVariables();
  }
  
  var pd = window.packingData;
  var rmd = window.rawMaterialData;
  var cc = window.columnConfig;
  
  if (!pd || !rmd || !cc) {
    console.error('–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã');
    return;
  }
  
  const heaterPowerInput = document.getElementById('heaterMaxPower');
  const heaterMaxPwr = heaterPowerInput ? parseFloat(heaterPowerInput.value) || 3500 : 3500;
  
  const diamMm = cc.diameterInch * 25.4;
  const heightCm = cc.heightM * 100;
  const packingDensity = cc.packingDensity / 100;
  
  // –ü–ª–æ—â–∞–¥—å —Å–µ—á–µ–Ω–∏—è (–º–º2)
  const radiusMm = diamMm / 2;
  const crossSectionMm2 = Math.PI * radiusMm * radiusMm;
  
  // HETP –∏ —Ç–∞—Ä–µ–ª–∫–∏ (—Å—á–∏—Ç–∞–µ–º –ü–ï–†–í–´–ú–ò, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å ReferenceError)
  const hetpBase = pd.hetpBase || 30; 
  const densityImpact = pd.densityImpact || 0.3;
  const hetpFactor = 1.0 - (packingDensity - 0.6) * (densityImpact / 0.4); 
  const hetp = hetpBase * hetpFactor;
  const theoreticalPlates = (hetp > 0) ? ((heightCm * 10) / hetp) : 1;
  
  // --- –†–ê–°–ß–Å–¢ –ú–û–©–ù–û–°–¢–ò –ó–ê–•–õ–Å–ë–ê ---
  const basePowerFactor = 1.15; 
  const pDensityAdj = 1.2 - (packingDensity - 0.6) * 0.5;
  const pHeightAdj = Math.pow(heightCm / 50, 0.35);
  
  const floodPowerW = Math.round(crossSectionMm2 * basePowerFactor * pDensityAdj * pHeightAdj);
  
  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–π –ø–æ—Ç–æ–∫ –ü–ê–†–ê –∫–æ–ª–æ–Ω–Ω—ã (–ø—Ä–∏ –∑–∞—Ö–ª–µ–±–µ)
  const evaporationFactor = 4.8; 
  const maxVaporFlowMlH = floodPowerW * evaporationFactor;
  
  // –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –û–¢–ë–û–†–ê (–∂–∏–¥–∫–æ—Å—Ç–∏) –ø—Ä–∏ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ —Å—Ç–∞–±–∏–ª—å–Ω–æ–º –§–ß=4
  // –≠—Ç–æ —Ä–µ–∞–ª—å–Ω—ã–π "–ø–∞—Å–ø–æ—Ä—Ç–Ω—ã–π" –ø—Ä–µ–¥–µ–ª –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∂–µ–ª–µ–∑–∞
  const maxLiquidFlowMlH = Math.round(maxVaporFlowMlH / (4 + 1));

  // –†–∞–±–æ—á–∏–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã
  const materialSelect = document.getElementById('loadprogram');
  const rawMaterialType = materialSelect ? parseInt(materialSelect.value) : 0;
  const rawData = rmd[rawMaterialType];
  
  // –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ –º–æ—â–Ω–æ—Å—Ç–∏ (–∏–∑ –ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞2.md): 
  let pWorkFactor = 0.75; // –°–∞—Ö–∞—Ä
  if (rawMaterialType === 0) pWorkFactor = 0.48; // –§—Ä—É–∫—Ç—ã
  if (rawMaterialType === 1) pWorkFactor = 0.62; // –ó–µ—Ä–Ω–æ
  
  const workingPowerW = Math.round(floodPowerW * pWorkFactor);
  const headsPowerW = Math.round(floodPowerW * (pWorkFactor * 0.9));
  const bodyEndPowerW = Math.round(workingPowerW * 1.05);
  const tailsPowerW = Math.round(workingPowerW * 1.1);
  
  // –†–∞–±–æ—á–∏–π –ø–æ—Ç–æ–∫ –ø–∞—Ä–∞ –ø—Ä–∏ —Ç–µ–∫—É—â–µ–π –º–æ—â–Ω–æ—Å—Ç–∏ (–¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ —Å–∫–æ—Ä–æ—Å—Ç–µ–π)
  const workingVaporFlowMlH = workingPowerW * evaporationFactor;
  
  // –§–ß –∏ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–†–µ—Ñ–µ—Ä–µ–Ω—Å: –¥–ª—è 1.5" –æ—Ç–±–æ—Ä —Ç–µ–ª–∞ ~0.7-0.9 –ª/—á, –≥–æ–ª–æ–≤ ~0.05-0.1 –ª/—á)
  const platesRatio = 20.0 / theoreticalPlates;
  
  // –î–ª—è –≥–æ–ª–æ–≤ –§–ß –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –≤—ã—Å–æ–∫–∏–º (200-300), —á—Ç–æ–±—ã —Å–∫–æ—Ä–æ—Å—Ç—å –±—ã–ª–∞ ~50-80 –º–ª/—á
  const headsFR = 250.0 * platesRatio; 
  let headsFlowMlH = workingVaporFlowMlH / (1 + headsFR);
  
  // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –≥–æ–ª–æ–≤ —Å–≤–µ—Ä—Ö—É (–Ω–µ –±–æ–ª–µ–µ 0.1 –ª/—á –¥–ª—è 1.5", 0.2 –ª/—á –¥–ª—è 2")
  const maxHeadsSpeed = crossSectionMm2 * 0.08;
  if (headsFlowMlH > maxHeadsSpeed) headsFlowMlH = maxHeadsSpeed;
  
  // –î–ª—è —Ç–µ–ª–∞ –§–ß –æ–±—ã—á–Ω–æ 5-8 –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–∞
  const bodyFR_Min = 5.0 * platesRatio * rawData.frMultiplier;
  const bodyFR_Max = 8.0 * platesRatio * rawData.frMultiplier;
  
  let bodyFlowMaxMlH = workingVaporFlowMlH / (1 + bodyFR_Min);
  let bodyFlowMinMlH = workingVaporFlowMlH / (1 + bodyFR_Max);
  
  // –§–∏–∑–∏—á–µ—Å–∫–∏–π –ø—Ä–µ–¥–µ–ª —Å–∫–æ—Ä–æ—Å—Ç–∏ –æ—Ç–±–æ—Ä–∞ –¥–ª—è –¥–∏–∞–º–µ—Ç—Ä–∞ —Ü–∞—Ä–≥–∏ (–∫–≥/—á –ø–∞—Ä–∞ –Ω–∞ –º–º2)
  const maxSafeBodySpeed = (crossSectionMm2 * 0.65); 

  // –ü—Ä–∏–º–µ–Ω—è–µ–º –∂–µ—Å—Ç–∫–∏–π –ª–∏–º–∏—Ç –∫–æ –í–°–ï–ú —Ñ—Ä–∞–∫—Ü–∏—è–º –æ—Ç–±–æ—Ä–∞
  const limitSpeed = (s) => Math.min(s, maxSafeBodySpeed);
  
  let bodyFlowMaxMlH_limited = limitSpeed(bodyFlowMaxMlH);
  let bodyFlowMinMlH_limited = limitSpeed(bodyFlowMinMlH);
  let headsFlowMlH_limited = limitSpeed(headsFlowMlH);

  // –°–∫–æ—Ä–æ—Å—Ç—å –¥–ª—è "–∫–æ–Ω—Ü–∞ —Ç–µ–ª–∞" (–ø–µ—Ä–µ–¥ —Ö–≤–æ—Å—Ç–∞–º–∏) –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –í–°–ï–ì–î–ê –Ω–∏–∂–µ –æ—Å–Ω–æ–≤–Ω–æ–π
  // –ë–µ—Ä–µ–º 60% –æ—Ç —Ç–µ–∫—É—â–µ–π –º–∞–∫—Å. —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ç–µ–ª–∞
  const bodyEndFlowMlH = bodyFlowMaxMlH_limited * 0.6;

  // –•–≤–æ—Å—Ç—ã –æ—Ç–±–∏—Ä–∞–µ–º –æ—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω–æ, –§–ß –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–∞–º—ã–º –≤—ã—Å–æ–∫–∏–º
  // –°–∫–æ—Ä–æ—Å—Ç—å —Ö–≤–æ—Å—Ç–æ–≤ –≤—Å–µ–≥–¥–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –Ω–∏–∂–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π —Å–∫–æ—Ä–æ—Å—Ç–∏ —Ç–µ–ª–∞
  const tailsFlowMlH = bodyEndFlowMlH * 0.7; 
  
  // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  cc.calculatedParams = {
    diameterMm: Math.round(diamMm),
    heightCm: Math.round(heightCm),
    crossSectionMm2: Math.round(crossSectionMm2),
    hetp: hetp,
    theoreticalPlates: theoreticalPlates,
    floodPowerW: floodPowerW,
    workingPowerW: workingPowerW,
    headsPowerW: headsPowerW,
    bodyEndPowerW: bodyEndPowerW,
    tailsPowerW: tailsPowerW,
    maxFlowMlH: maxLiquidFlowMlH,
    headsFlowMlH: headsFlowMlH_limited,
    bodyFlowMinMlH: bodyFlowMinMlH_limited,
    bodyFlowMaxMlH: bodyFlowMaxMlH_limited,
    bodyEndFlowMlH: bodyEndFlowMlH,
    tailsFlowMlH: tailsFlowMlH,
    frCoeffA: 0.002 * platesRatio * rawData.frMultiplier,
    frCoeffB: -0.15 * platesRatio * rawData.frMultiplier,
    frCoeffC: 4.0 * platesRatio * rawData.frMultiplier
  };

  
  window.columnConfig.calculatedParams = cc.calculatedParams;
  displayColumnParams();
  return cc.calculatedParams;
}

// –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
function displayColumnParams() {
  const p = window.columnConfig ? window.columnConfig.calculatedParams : null;
  if (!p) return;
  
  // –ü–æ–ª—É—á–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
  const floodPowerEl = document.getElementById('colFloodPower');
  const workingPowerEl = document.getElementById('colWorkingPower');
  const maxFlowEl = document.getElementById('colMaxFlow');
  const theoreticalPlatesEl = document.getElementById('colTheoreticalPlates');
  const headsSpeedEl = document.getElementById('colHeadsSpeed');
  const bodySpeedMinEl = document.getElementById('colBodySpeedMin');
  const bodySpeedMaxEl = document.getElementById('colBodySpeedMax');
  const tailsSpeedEl = document.getElementById('colTailsSpeed');
  const resultsBlock = document.getElementById('columnParamsResults');
  
  // –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
  if (!floodPowerEl || !workingPowerEl || !maxFlowEl || !theoreticalPlatesEl ||
      !headsSpeedEl || !bodySpeedMinEl || !bodySpeedMaxEl || !tailsSpeedEl || !resultsBlock) {
    // –≠–ª–µ–º–µ–Ω—Ç—ã –µ—â—ë –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –ø–æ–ø—Ä–æ–±—É–µ–º –ø–æ–∑–∂–µ
    return;
  }
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  const heaterPowerInput = document.getElementById('heaterMaxPower');
  const heaterMaxPwr = heaterPowerInput ? parseFloat(heaterPowerInput.value) || 3500 : 3500;

  floodPowerEl.textContent = pwr_unit === 'V' ? Math.round(220 * Math.sqrt(p.floodPowerW / heaterMaxPwr)) : p.floodPowerW.toFixed(0);
  workingPowerEl.textContent = pwr_unit === 'V' ? Math.round(220 * Math.sqrt(p.workingPowerW / heaterMaxPwr)) : p.workingPowerW.toFixed(0);
  maxFlowEl.textContent = p.maxFlowMlH.toFixed(0);
  theoreticalPlatesEl.textContent = p.theoreticalPlates.toFixed(1);
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–¥–ø–∏—Å–∏ –µ–¥–∏–Ω–∏—Ü –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö, –µ—Å–ª–∏ –æ–Ω–∏ –µ—Å—Ç—å
  const floodUnit = floodPowerEl.nextSibling;
  if (floodUnit && floodUnit.nodeType === 3 && floodUnit.textContent.includes('–í—Ç')) {
    floodUnit.textContent = pwr_unit === 'V' ? ' –í' : ' –í—Ç';
  }
  const workingUnit = workingPowerEl.nextSibling;
  if (workingUnit && workingUnit.nodeType === 3 && workingUnit.textContent.includes('–í—Ç')) {
    workingUnit.textContent = pwr_unit === 'V' ? ' –í' : ' –í—Ç';
  }

  
  // –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏ (–≤ –ª/—á)
  headsSpeedEl.textContent = (p.headsFlowMlH / 1000).toFixed(3);
  bodySpeedMinEl.textContent = (p.bodyFlowMinMlH / 1000).toFixed(3);
  bodySpeedMaxEl.textContent = (p.bodyFlowMaxMlH / 1000).toFixed(3);
  
  const tailsPwrDisplay = pwr_unit === 'V' ? Math.round(220 * Math.sqrt(p.tailsPowerW / heaterMaxPwr)) : p.tailsPowerW.toFixed(0);
  const tailsPwrUnit = pwr_unit === 'V' ? ' –í' : ' –í—Ç';
  
  const bodyEndPwrDisplay = pwr_unit === 'V' ? Math.round(220 * Math.sqrt(p.bodyEndPowerW / heaterMaxPwr)) : p.bodyEndPowerW.toFixed(0);
  
  tailsSpeedEl.textContent = (p.tailsFlowMlH / 1000).toFixed(3) + ' (–ø—Ä–∏ ' + tailsPwrDisplay + tailsPwrUnit + ')';
  
  // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω—Ñ–æ –ø—Ä–æ –∫–æ–Ω–µ—Ü —Ç–µ–ª–∞, –µ—Å–ª–∏ –±–ª–æ–∫ –µ—Å—Ç—å
  const bodyInfo = bodySpeedMaxEl.parentNode;
  if (bodyInfo) {
    let endBodyNote = bodyInfo.querySelector('.body-end-note');
    if (!endBodyNote) {
      endBodyNote = document.createElement('div');
      endBodyNote.className = 'body-end-note';
      endBodyNote.style.fontSize = '0.85em';
      endBodyNote.style.marginTop = '4px';
      endBodyNote.style.color = '#666';
      bodyInfo.appendChild(endBodyNote);
    }
    endBodyNote.innerHTML = 'üëâ –ö–æ–Ω–µ—Ü —Ç–µ–ª–∞ (<15% ABV): <b>' + (p.bodyEndFlowMlH / 1000).toFixed(3) + '</b> –ª/—á (–ø—Ä–∏ <b>' + bodyEndPwrDisplay + tailsPwrUnit + '</b>)';
  }
  
  // –°—Ç—Ä–∞—Ç–µ–≥–∏—è –ø–æ —Å—ã—Ä—å—é (–∏–∑ –ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞2.md)
  const strategyNote = document.getElementById('strategyNote');
  if (strategyNote) {
    const materialSelect = document.getElementById('loadprogram');
    const rawMaterialType = materialSelect ? parseInt(materialSelect.value) : 0;
    
    if (rawMaterialType === 0) {
      strategyNote.innerHTML = 'üçé <b>–°—Ç—Ä–∞—Ç–µ–≥–∏—è "–§—Ä—É–∫—Ç—ã":</b> –ü–ª—ë–Ω–æ—á–Ω—ã–π —Ä–µ–∂–∏–º (–Ω–∏–∑–∫–æ–µ –§–ß) –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∞—Ä–æ–º–∞—Ç–∞. –ò–∑–æ–∞–º–∏–ª–æ–ª –æ—Ç—Å–µ–∫–∞–µ—Ç—Å—è –≤ –∫–æ–Ω—Ü–µ –æ—Ç–±–æ—Ä–∞.';
      strategyNote.style.color = '#e67e22'; 
      strategyNote.style.borderLeft = '4px solid #e67e22';
    } else if (rawMaterialType === 1) {
      strategyNote.innerHTML = 'üåæ <b>–°—Ç—Ä–∞—Ç–µ–≥–∏—è "–ó–µ—Ä–Ω–æ":</b> –ë–∞–ª–∞–Ω—Å –º–µ–∂–¥—É –æ—á–∏—Å—Ç–∫–æ–π –∏ –≤–∫—É—Å–æ–º. –°—Ä–µ–¥–Ω—è—è –º–æ—â–Ω–æ—Å—Ç—å –∏ –§–ß.';
      strategyNote.style.color = '#d35400';
      strategyNote.style.borderLeft = '4px solid #d35400';
    } else {
      strategyNote.innerHTML = 'üíé <b>–°—Ç—Ä–∞—Ç–µ–≥–∏—è "–°–∞—Ö–∞—Ä":</b> –†–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è (–≤—ã—Å–æ–∫–æ–µ –§–ß) –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —á–∏—Å—Ç–æ—Ç—ã —Å–ø–∏—Ä—Ç–∞.';
      strategyNote.style.color = '#2980b9';
      strategyNote.style.borderLeft = '4px solid #2980b9';
    }
  }
  
  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –±–ª–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
  resultsBlock.style.display = 'block';
}

// –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã—Ö —Å–∫–æ—Ä–æ—Å—Ç–µ–π –∏ –º–æ—â–Ω–æ—Å—Ç–∏ –∫ –ø—Ä–æ–≥—Ä–∞–º–º–µ
function applyRecommendedSpeeds() {
  if (!window.columnConfig || !window.columnConfig.calculatedParams) {
    alert('–°–Ω–∞—á–∞–ª–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–ª–æ–Ω–Ω—ã');
    return;
  }
  
  const p = window.columnConfig.calculatedParams;
  const programLines = document.getElementById('prg').childNodes;
  let appliedCount = 0;
  
  // –ù–∞–π–¥–µ–º –≤—Å–µ —Å—Ç—Ä–æ–∫–∏ —Å —Ç–∏–ø–æ–º "–¢–µ–ª–æ" (B) –∏–ª–∏ "–ü—Ä–µ–¥–∑–∞—Ö–ª–µ–±" (C) –¥–ª—è –ø–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è
  let bodyLineIndices = [];
  for (let i = 1; i < programLines.length; i++) {
    const line = programLines[i];
    if (!line || !line.childNodes) continue;
    const typeSelect = line.querySelector('select[name^="ptype"]');
    if (typeSelect && (typeSelect.value === 'B' || typeSelect.value === 'C')) {
      bodyLineIndices.push(i);
    }
  }
  
  for (let i = 1; i < programLines.length; i++) {
    const line = programLines[i];
    if (!line || !line.childNodes) continue;
    
    const typeSelect = line.querySelector('select[name^="ptype"]');
    const speedInput = line.querySelector('input[name^="speed"]');
    const powerInput = line.querySelector('input[name^="pvolt"]');
    
    if (!typeSelect || !speedInput) continue;
    
    const type = typeSelect.value;
    let recommendedSpeed = 0;
    let recommendedPower = 0;
    
    switch(type) {
      case 'H': // –ì–æ–ª–æ–≤—ã
        recommendedSpeed = p.headsFlowMlH;
        recommendedPower = p.headsPowerW;
        break;
      case 'B': // –¢–µ–ª–æ
      case 'C': // –ü—Ä–µ–¥–∑–∞—Ö–ª–µ–±
        if (bodyLineIndices.length > 1) {
          const bodyIdx = bodyLineIndices.indexOf(i);
          const t = bodyIdx / (bodyLineIndices.length - 1);
          
          // –°–∫–æ—Ä–æ—Å—Ç—å –í–°–ï–ì–î–ê –¥–æ–ª–∂–Ω–∞ —Å–Ω–∏–∂–∞—Ç—å—Å—è –æ—Ç Max –¥–æ End
          recommendedSpeed = p.bodyFlowMaxMlH - (p.bodyFlowMaxMlH - p.bodyEndFlowMlH) * t;
          
          // –ú–æ—â–Ω–æ—Å—Ç—å –í–°–ï–ì–î–ê –¥–æ–ª–∂–Ω–∞ —Ä–∞—Å—Ç–∏. 
          if (type === 'C') {
            recommendedPower = p.floodPowerW;
          } else {
            // –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é –º–æ—â–Ω–æ—Å—Ç–∏: –æ—Ç —Ä–∞–±–æ—á–µ–π –¥–æ –∫–æ–Ω–µ—á–Ω–æ–π (+5%)
            recommendedPower = p.workingPowerW + (p.bodyEndPowerW - p.workingPowerW) * t;
          }
        } else {
          recommendedSpeed = p.bodyFlowMaxMlH;
          recommendedPower = (type === 'C') ? p.floodPowerW : p.workingPowerW;
        }
        break;
      case 'T': // –•–≤–æ—Å—Ç—ã
        recommendedSpeed = p.tailsFlowMlH;
        recommendedPower = p.tailsPowerW;
        break;
      default:
        continue;
    }
    
    if (recommendedSpeed > 0) {
      speedInput.value = (parseFloat(recommendedSpeed) / 1000).toFixed(3);
      if (powerInput && recommendedPower > 0) {
        if (pwr_unit === 'V') {
          // –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –º–æ—â–Ω–æ—Å—Ç–∏ (–í—Ç) –≤ –Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ (–í) –¥–ª—è –∑–∞–¥–∞–Ω–Ω–æ–≥–æ –¢–≠–ù–∞
          const heaterPowerInput = document.getElementById('heaterMaxPower');
          const heaterMaxPwr = heaterPowerInput ? parseFloat(heaterPowerInput.value) || 3500 : 3500;
          powerInput.value = Math.round(220 * Math.sqrt(recommendedPower / heaterMaxPwr));
        } else {
          powerInput.value = Math.round(recommendedPower);
        }
      }
      appliedCount++;
    }
  }
  
  // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –≤—Å—é –ø—Ä–æ–≥—Ä–∞–º–º—É
  set_num();
  
  if (appliedCount > 0) {
    alert('‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã (–º–æ—â–Ω–æ—Å—Ç—å –∏ —Å–∫–æ—Ä–æ—Å—Ç—å) –ø—Ä–∏–º–µ–Ω–µ–Ω—ã –∫ ' + appliedCount + ' —Å—Ç—Ä–æ–∫–∞–º –ø—Ä–æ–≥—Ä–∞–º–º—ã');
  } else {
    alert('‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω–æ —Å—Ç—Ä–æ–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤');
  }
}


// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å–∞–¥–∫–∏
function updatePackingDensityDisplay(value) {
  const val = parseInt(value);
  const valueElement = document.getElementById('packingDensityValue');
  const descElement = document.getElementById('packingDensityDesc');
  
  if (!valueElement || !descElement) {
    // –≠–ª–µ–º–µ–Ω—Ç—ã –µ—â–µ –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã, –Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ–º
    return;
  }
  
  valueElement.textContent = val + '%';
  
  let desc = '';
  if (val < 70) desc = '–†–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è';
  else if (val < 85) desc = '–°—Ä–µ–¥–Ω—è—è';
  else if (val < 95) desc = '–ü–ª–æ—Ç–Ω–∞—è';
  else desc = '–û—á–µ–Ω—å –ø–ª–æ—Ç–Ω–∞—è';
  descElement.textContent = desc;
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
function updateColumnConfig() {
  try {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
    if (!window.columnConfig) {
      if (typeof initColumnVariables === 'function') {
        initColumnVariables();
      } else {
        console.error('columnConfig –Ω–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–∞');
        return;
      }
    }
    
    const diameterSelect = document.getElementById('columnDiameter');
    if (diameterSelect) {
      const value = parseFloat(diameterSelect.value);
      if (!isNaN(value)) {
        window.columnConfig.diameterInch = value;
        console.log('–î–∏–∞–º–µ—Ç—Ä –∫–æ–ª–æ–Ω–Ω—ã –æ–±–Ω–æ–≤–ª–µ–Ω:', value);
      }
    }
    
    const heightSelect = document.getElementById('columnHeight');
    if (heightSelect) {
      const value = parseFloat(heightSelect.value);
      if (!isNaN(value)) {
        window.columnConfig.heightM = value;
        console.log('–í—ã—Å–æ—Ç–∞ –Ω–∞—Å–∞–¥–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞:', value);
      }
    }
    
    const densityInput = document.getElementById('packingDensity');
    if (densityInput) {
      const value = parseFloat(densityInput.value);
      if (!isNaN(value)) {
        window.columnConfig.packingDensity = value;
        console.log('–ü–ª–æ—Ç–Ω–æ—Å—Ç—å –Ω–∞—Å–∞–¥–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞:', value);
      }
    }
    
    const materialSelect = document.getElementById('loadprogram');
    if (materialSelect) {
      const value = parseInt(materialSelect.value);
      if (!isNaN(value)) {
        window.columnConfig.rawMaterial = value;
        console.log('–¢–∏–ø —Å—ã—Ä—å—è –æ–±–Ω–æ–≤–ª–µ–Ω:', value);
      }
    }
    
    // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
    if (typeof calculateColumnParams === 'function') {
      calculateColumnParams();
    } else {
      console.error('calculateColumnParams –Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞');
    }
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –≤ updateColumnConfig:', error);
  }
}

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–ø–∏—Å–∫–∞ –≤—ã—Å–æ—Ç –æ—Ç 0.5 –¥–æ 3 –º–µ—Ç—Ä–æ–≤ —Å —à–∞–≥–æ–º 0.25
function generateHeightOptions() {
  let options = '';
  for (let h = 0.5; h <= 3.0; h += 0.25) {
    const cm = Math.round(h * 100);
    options += `<option value="${h}">${h.toFixed(2)} –º (${cm} —Å–º)</option>`;
  }
  return options;
}

function loadFile(e) {
	var file = e;
	var reader = new FileReader();
	reader.onload = function () {
		document.getElementById('WProgram1').value = reader.result;
		glcalcnum = false;
		calc_program();
	};
	reader.readAsText(file, "UTF-8");
}

function getProgramFromFile(selectObject){
var value = selectObject.value;
var fn;
if (value == 0) fn = 'program_fruit.txt';
else if (value == 1) fn = 'program_grain.txt';
else if (value == 2) fn = 'program_shugar.txt';

// –û–±–Ω–æ–≤–ª—è–µ–º –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é –∫–æ–ª–æ–Ω–Ω—ã –ø—Ä–∏ —Å–º–µ–Ω–µ —Ç–∏–ø–∞ —Å—ã—Ä—å—è
updateColumnConfig();

fetch(fn)
  .then(response => response.text())
  .then((data) => {
  document.getElementById('WProgram1').value = data
  glcalcnum = false;
  calc_program();
  })
}

function SaveProgramToFile() {
  var filename, text;
  filename = 'programbackup.txt';
  text = document.getElementById('WProgram1').value;

  var pom = document.createElement('a');
  pom.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
  pom.setAttribute('download', filename);

  pom.style.display = 'none';
  document.body.appendChild(pom);

  pom.click();

  document.body.removeChild(pom);
}

function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tablinks");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
  return 0;
}

function check_program(str){
  var arrayOfStrings = str.split("\n");
  var prevcnt = 0;
  var ret = true;
  var cnt;
  for (i = 0; i < arrayOfStrings.length; i++){
  	var arrayOfDelim = arrayOfStrings[i].split(";");
  	cnt = arrayOfDelim.length;
  	if (cnt == 1 && arrayOfDelim[0] != "" && arrayOfStrings.length == i - 1) ret = false;
  	else if (prevcnt > 0 && cnt > 1) {
  		if (prevcnt != cnt) ret = false;
  	}
  	prevcnt = cnt;
  }
  return ret;
}

function get_time(tm){
  var s = "";
  l = Math.trunc(tm);
  if (l < 10) s = "0";
  s = s + l + ":";
  l = Math.trunc((tm - Math.trunc(tm)) * 60);
  if (l < 10) s = s + "0";
  s = s + l;
  return s;
}

function set_num(){
    prep_calc();
    programerr = false;
    var e = document.getElementById("prg").childNodes;
    var a;
    var v;
    var t;
    var l;
    var sum = 0;
    var sumh = 0;
    var sumt = 0;
    var sumb = 0;
    var prgc = "";
    var prgo = "";
    for (i=1;i<e.length;i++){
      a = e[i].childNodes[0];
      a.innerText = "";
      if (i < 10) a.innerText = "0";
      a.innerText = a.innerText + i;
      //
      if (e[i].childNodes[3].value.indexOf(".") > 0) e[i].childNodes[3].value = e[i].childNodes[3].value.substring(0, e[i].childNodes[3].value.indexOf("."));
      if (e[i].childNodes[3].value.indexOf(",") > 0) e[i].childNodes[3].value = e[i].childNodes[3].value.substring(0, e[i].childNodes[3].value.indexOf(","));
      
      e[i].childNodes[2].value = e[i].childNodes[2].value.replace(",",".");
      e[i].childNodes[5].value = e[i].childNodes[5].value.replace(",",".");

      // –ü–æ–ª—É—á–∞–µ–º –Ω–æ–º–µ—Ä –µ–º–∫–æ—Å—Ç–∏ –∏–∑ —Å–µ–ª–µ–∫—Ç–∞
      var capacitySelect = document.getElementById("pnum" + (i-1));
      var capacityNum = capacitySelect ? capacitySelect.value : "0";

      v = e[i].childNodes[6];
      t = e[i].childNodes[7];
      var vlc = 1;
      if (e[i].childNodes[4].value == "H") {
        vlc = phv / 100;
        sumh = sumh + Number(e[i].childNodes[3].value);
      }
      else if (e[i].childNodes[4].value == "T") {
        vlc = ptv / 100;
      }
      else if (e[i].childNodes[4].value == "P") {
        vlc = 1;
      }
      else if (e[i].childNodes[4].value == "B" || e[i].childNodes[4].value == "C") {
        vlc = pbas / 100;
        sumb = sumb + Number(e[i].childNodes[3].value);
      }
      ll = (e[i].childNodes[3].value * vlc)
      prgc = prgc + e[i].childNodes[4].value + ";";
      if (e[i].childNodes[4].value == "P") {
	    v.value = e[i].childNodes[2].value;
	    a = v.value / 3600;
	    prgc = prgc + v.value;
      }
      else {
        v.value = ll.toFixed(3);
        a = v.value / e[i].childNodes[2].value;
	    prgc = prgc + v.value * 1000;
      }
      prgc = prgc + ";" + e[i].childNodes[2].value + ";" + capacityNum + ";0;" + e[i].childNodes[5].value + "\n";
      t.value = get_time(a);
      sum = sum + Number(a);
      prgo = prgo + capacityNum + ";" + e[i].childNodes[2].value + ";" + e[i].childNodes[3].value + ";" + e[i].childNodes[4].value + ";" + e[i].childNodes[5].value + "\n"
    }
    document.getElementById("sum").value = get_time(sum);
    var err = ""
    programerr = false;
    if (sumh != 100) err = "–û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ - –æ–±—ä–µ–º –≥–æ–ª–æ–≤–Ω—ã—Ö —Ñ—Ä–∞–∫—Ü–∏–π –Ω–µ —Ä–∞–≤–µ–Ω 100 (" + sumh + ")";
    if (sumb != 100) err = "–û—à–∏–±–∫–∞ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–µ - –æ–±—ä–µ–º —Ñ—Ä–∞–∫—Ü–∏–∏ —Ç–µ–ª–∞ –Ω–µ —Ä–∞–≤–µ–Ω 100 (" + sumb + ")";
    if (err !=""){
      //alert(err);
      programerr = true;
    }
//    if (!programerr) {
      prgc = prgc.slice(0, -1);
      prgo = prgo.slice(0, -1);
      document.getElementById("WProgram1").value = prgo;
      document.getElementById("WProgram").value = prgc;
//    }
    return programerr;
}

function prep_calc(){
    var vless = document.getElementById('vless').value; //A3
    var vlssp = document.getElementById('vlssp').value / 100; //B3
    var vlp = document.getElementById('vlp').value / 100; //B5
    var vlhp = document.getElementById('vlhp').value / 100; //E3
    var vltp = document.getElementById('vltp').value / 100; //H3
    var tas = vless * vlssp; //–°3
    var pas = tas / vlp; //–°5
    var thv = tas * vlhp //F3
    phv = thv / vlp; //F5
    var ttv = tas * vltp; //I3
    ptv = ttv / vlp * 2; //I5
    var tht = ttv + thv; //K3
    var pht = ptv + phv; //K5
    var tbas = tas - tht; //M3
    pbas = tbas / vlp; //M5
    var ttr = vless - tht - tbas; //Q3
    var ptr = (vless - pht - pbas) * 0.9; //Q5
    document.getElementById('trest').value = ptr.toFixed(2);
}

function calc_program(){
    prep_calc();
    let programPwrLabel = pwr_unit == 'P' ? '–ú–æ—â–Ω' : '–ù–∞–ø—Ä';   
    var e = document.getElementById("prg");
    
    while (e.firstChild) {
      e.removeChild(e.firstChild);
    }
      _lnIdx = 0;

    e.insertAdjacentHTML("afterbegin", `<div class="flex_row" style="font-size:18px; margin-bottom: 0.5em; margin-top: 0.5em" id="hdr">
      &nbsp;&nbsp;&nbsp;<label class="tooltip">‚Ññ<span class="tooltiptext">–ù–æ–º–µ—Ä —Å—Ç—Ä–æ–∫–∏ –ø—Ä–æ–≥—Ä–∞–º–º—ã</span></label>
      &nbsp;&nbsp;<label class="tooltip">–Å–º–∫–æ—Å—Ç—å<span class="tooltiptext">–ù–æ–º–µ—Ä —ë–º–∫–æ—Å—Ç–∏ (–Ω—É–º–µ—Ä–∞—Ü–∏—è –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è –æ—Ç 0)</span></label>
      &nbsp;<label class="tooltip">–°–∫–æ—Ä–æ—Å—Ç—å<span class="tooltiptext">–°–∫–æ—Ä–æ—Å—Ç—å –≤ –ª–∏—Ç—Ä–∞—Ö –≤ —á–∞—Å. –î–ª—è —Å—Ç—Ä–æ–∫–∏ —Å —Ç–∏–ø–æ–º "–ü–∞—É–∑–∞" - –≤—Ä–µ–º—è –ø–∞—É–∑—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö</span></label>
      &nbsp;<label class="tooltip">–ü—Ä–æ—Ü–µ–Ω—Ç<span class="tooltiptext">–ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç –æ–±—ä–µ–º–∞ —Ñ—Ä–∞–∫—Ü–∏–∏ –¥–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞</span></label>&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="tooltip">–¢–∏–ø<span class="tooltiptext">–¢–∏–ø –ø—Ä–æ–≥—Ä–∞–º–º—ã. –î–ª—è —Ä–µ–∂–∏–º–∞ –ü–∞—É–∑–∞ –≤—Ä–µ–º—è –ø–∞—É–∑—ã –≤ —Å–µ–∫—É–Ω–¥–∞—Ö –∑–∞–¥–∞–µ—Ç—Å—è –≤ –ø–æ–ª–µ "–°–∫–æ—Ä–æ—Å—Ç—å"</span></label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="tooltip">${programPwrLabel}<span class="tooltiptext">–ù–∞–ø—Ä—è–∂–µ–Ω–∏–µ –∏–ª–∏ –º–æ—â–Ω–æ—Å—Ç—å –Ω–∞ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–µ (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ç–∏–ø–∞ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–≥–æ —Ä–µ–≥—É–ª—è—Ç–æ—Ä–∞)</span></label>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="tooltip">–í—ã—Ö–æ–¥<span class="tooltiptext">–û–±—ä–µ–º –æ—Ç–±–∏—Ä–∞–µ–º–æ–π —Ñ—Ä–∞–∫—Ü–∏–∏ –≤ –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã</span></label>
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<label class="tooltip">–í—Ä–µ–º—è<span class="tooltiptext">–í—Ä–µ–º—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –Ω–∞ –æ—Ç–±–æ—Ä —Ñ—Ä–∞–∫—Ü–∏–∏ –≤ –¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã</span></label></div>`);
    var p = document.getElementById("WProgram1");
    var arr = p.value.split("\n");
    for (z=0;z<arr.length;z++){
      addLine(false, arr[z]);
    }
    glcalcnum = true;
    set_num();
}

function set_program(){
glcalcnum = false;
calc_program();
if (programerr) {
  alert( "–í –ø—Ä–æ–≥—Ä–∞–º–º–µ –æ—à–∏–±–∫–∞! –ü—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞" );
  return;
}
var server = '/program';
request = new XMLHttpRequest();
request.onreadystatechange = function() {
if (this.readyState == 4 && this.status == 200) {
var myObj = this.responseText;
if (myObj != "OK") {
  document.getElementById('WProgram').value = myObj;
  alert( "Ok" );
}
}
};
request.open('POST', server, false);
let formData = new FormData(document.forms.mainform);
request.send(formData);
if(request.status != 200) {
alert( request.status + ': ' + request.statusText );
}
return 0;
};

function sendbutton(command){
var server = '/command?' + command;
request = new XMLHttpRequest();
request.open('GET', server, false);
request.send();
if(request.status != 200) {
alert( request.status + ': ' + request.statusText );
}
sleep(1000);
return 0;
};

function removeLine(ln){
  var prg = document.getElementById("prg").childNodes.length;
  if (prg < 3) return;
  var prgline = document.getElementById(ln);
  prgline.remove();
  set_num();
}

function addLine(obj, s){
  var calcnum = false;
  if (obj && s == "") {
    var p = document.getElementById(obj).childNodes;
    var ss = "0";
    var sp = 1;
    s = p[1].value + ";" + p[2].value + ";" + ss + ";" + p[4].value + ";0";
    calcnum = true;
  }
  var arr = s.split(";");
  
  var dl = document.createElement("div");
  dl.className = "prgline";
  dl.id = "prgln" + _lnIdx;
  
  var num = document.createElement("label");
  num.className = "prglabel";
  dl.appendChild(num);
  
  num.insertAdjacentHTML("afterend", '<select id="pnum' + _lnIdx + '" name="pnum' + _lnIdx + '"><option value="0">0</option><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option><option value="5">5</option><option value="6">6</option><option value="7">7</option><option value="8">8</option><option value="9">9</option><option value="10">10</option></select>');
  
  var speed = document.createElement("input");
  speed.type = "text";
  speed.name = "speed" + _lnIdx;
  speed.value = arr[1];
  speed.setAttribute("onchange", "set_num();");
  dl.appendChild(speed);
  
  var percent = document.createElement("input");
  percent.type = "text";
  percent.name = "percent" + _lnIdx;
  percent.value = arr[2];
  percent.setAttribute("onchange", "set_num();");
  dl.appendChild(percent);
  
  percent.insertAdjacentHTML("afterend", '<select id="ptype' + _lnIdx + '" name="ptype' + _lnIdx + '" onchange="set_bgcolor(' + _lnIdx + ')"><option value="H">–ì–æ–ª–æ–≤—ã</option><option value="B">–¢–µ–ª–æ</option><option value="C">–ü—Ä–µ–¥–∑–∞—Ö–ª–µ–±</option><option value="T">–•–≤–æ—Å—Ç—ã</option><option value="P">–ü–∞—É–∑–∞</option></select>');
  
  var pvolt = document.createElement("input");
  pvolt.type = "text";
  pvolt.name = "pvolt" + _lnIdx;
  pvolt.value = arr[4];
  pvolt.setAttribute("onchange", "set_num();");
  dl.appendChild(pvolt);
  
  var pvl = document.createElement("input");
  pvl.type = "text";
  pvl.name = "pvl" + _lnIdx;
  pvl.setAttribute("disabled", "");
  dl.appendChild(pvl);

  var tm = document.createElement("input");
  tm.type = "text";
  tm.name = "tm" + _lnIdx;
  tm.setAttribute("disabled", "");
  dl.appendChild(tm);

  var plus = document.createElement("img");
  plus.src = 'plus.png';
  plus.setAttribute("width", "20");
  plus.setAttribute("onclick", "addLine('prgln" + _lnIdx + "','')");
  dl.appendChild(plus);
  
  var minus = document.createElement("img");
  minus.src = 'minus.png';
  minus.setAttribute("width", "20");
  minus.setAttribute("onclick", "removeLine('prgln" + _lnIdx + "')");
  dl.appendChild(minus);

  if (!obj){
    var prg = document.getElementById("prg");
    prg.appendChild(dl);
  } else {
    prg = document.getElementById(obj);
    prg.after(dl);
  }

  var p = "ptype" + _lnIdx;
  var ptype = document.getElementById(p);
  ptype.value = arr[3];

  var pnum = document.getElementById("pnum" + _lnIdx);
  pnum.selectedIndex = arr[0];
  pnum.onchange = set_num;
  
  set_bgcolor(_lnIdx);
  
  _lnIdx++;
  
  if (calcnum) set_num();
}

function set_bgcolor(obj){
  var l = document.getElementById("prgln" + obj);
  var t = document.getElementById("ptype" + obj).value;
  if (t == "H"){color = "background-color: #80FFFA;";}
  else if (t == "B"){color = "background-color: #32CD3229;";}
  else if (t == "C"){color = "background-color: #FFFF0039;";}
  else if (t == "P"){color = "background-color: #C4C4C4;";}
  else if (t == "T"){color = "background-color: #8B451334;";}
  l.setAttribute("style",color);
  var e = l.childNodes;
  for(q=0;q<e.length;q++){
    e[q].setAttribute("style",color);
  }
  if (glcalcnum) set_num();
}

window.onload = function() {
  // –ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
  if (typeof initColumnVariables === 'function') {
    initColumnVariables();
  }
  
  // –ü–æ–ª—É—á–∞–µ–º –≤—Å–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–ª–æ–Ω–Ω—ã
  const diameterSelect = document.getElementById('columnDiameter');
  const heightSelect = document.getElementById('columnHeight');
  const densitySlider = document.getElementById('packingDensity');
  const loadProgramSelect = document.getElementById("loadprogram");
  
  // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–ø–∏—Å–æ–∫ –≤—ã—Å–æ—Ç
  if (heightSelect) {
    const heightOptions = generateHeightOptions();
    heightSelect.innerHTML = heightOptions;
    heightSelect.value = '0.5'; // –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –æ–ø–∏—Å–∞–Ω–∏—è –ø–ª–æ—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å–∞–¥–∫–∏
  if (densitySlider) {
    updatePackingDensityDisplay(densitySlider.value);
  }
  
  // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π –¥–ª—è —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–æ–ª–æ–Ω–Ω—ã
  if (diameterSelect) {
    diameterSelect.addEventListener('change', function() {
      console.log('–î–∏–∞–º–µ—Ç—Ä –∏–∑–º–µ–Ω–µ–Ω:', this.value);
      updateColumnConfig();
    });
  }
  
  if (heightSelect) {
    heightSelect.addEventListener('change', function() {
      console.log('–í—ã—Å–æ—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∞:', this.value);
      updateColumnConfig();
    });
  }
  
  if (densitySlider) {
    densitySlider.addEventListener('input', function() {
      updatePackingDensityDisplay(this.value);
      updateColumnConfig();
    });
  }
  
  // –ü—Ä–∏–≤—è–∑–∫–∞ —Å–æ–±—ã—Ç–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∏–ø–∞ —Å—ã—Ä—å—è –∫ –ø–µ—Ä–µ—Å—á—ë—Ç—É –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
  if (loadProgramSelect) {
    loadProgramSelect.addEventListener("change", function() {
      updateHeadsTailsPercent(); // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ü–µ–Ω—Ç—ã –≥–æ–ª–æ–≤ –∏ —Ö–≤–æ—Å—Ç–æ–≤
      updateColumnConfig(); // –ü–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ–º –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∫–æ–ª–æ–Ω–Ω—ã
    });
  }

  // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞ –º–æ—â–Ω–æ—Å—Ç–∏ –¢–≠–ù–∞, –µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ–º –≤ –≤–æ–ª—å—Ç–∞—Ö
  const heaterBlock = document.getElementById('heaterPowerBlock');
  if (heaterBlock && pwr_unit === 'V') {
    heaterBlock.style.display = 'block';
  }
  const heaterPowerInput = document.getElementById('heaterMaxPower');
  if (heaterPowerInput) {
    heaterPowerInput.addEventListener('change', function() {
      calculateColumnParams();
    });
  }
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∫–æ–ª–æ–Ω–Ω—ã (–ø–æ—Å–ª–µ –ø—Ä–∏–≤—è–∑–∫–∏ —Å–æ–±—ã—Ç–∏–π)
  if (typeof calculateColumnParams === 'function') {
    calculateColumnParams();
  }
  
  if (loadProgramSelect) {
    updateHeadsTailsPercent(); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –Ω–∞—á–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ–Ω—Ç–æ–≤
    getProgramFromFile(loadProgramSelect);
  }
  return;
  getProgram();
  document.getElementById("WProgram1").addEventListener("change", function(event) {
    if (!check_program(document.getElementById('WProgram1').value)){
      alert( "Program error!" );
      return;
    }  
    var element = document.getElementById("prg");
    while (element.firstChild) {
      element.removeChild(element.firstChild);
    }
    _lnIdx = 0;
    getProgram();
  });
};

</script>
</head>
<body>
<form action='none' onsubmit='return false' name="mainform" id="mainform">
<h1>
<div class="message-box" style="display: none;" id="message"></div>
Samovar v. <span id='version'>%v%</span>
</h1>
<div class="text">–†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç–±–æ—Ä–∞
<select id="loadprogram" name="loadprogram" onchange="getProgramFromFile(this)">
  <option value="0">–§—Ä—É–∫—Ç—ã</option>
  <option value="1">–ó–µ—Ä–Ω–æ</option>
  <option value="2">–°–∞—Ö–∞—Ä</option>
</select>
</div>

<!-- –ë–õ–û–ö –ù–ê–°–¢–†–û–ô–ö–ò –ö–û–õ–û–ù–ù–´ -->
<div class="tabcontent" style="display: block;border-top: solid;border-top-width: 1px;border-top-color: rgb(204, 204, 204);">
<div class="container_row" style="border: 2px solid #3498db; margin-bottom: 20px; background: #fafafa; border-radius: 5px;">
  <div style="width: 100%;">
    <div style="color: #3498db; font-weight: bold; margin-bottom: 15px; font-size: 1.2em; border-bottom: 1px solid #ddd; padding-bottom: 5px;">
      ‚öôÔ∏è –ü–ê–†–ê–ú–ï–¢–†–´ –û–ë–û–†–£–î–û–í–ê–ù–ò–Ø
    </div>
    
    <div class="prgline" style="margin-bottom: 10px;">
      <label class="prglabel" style="width: 150px; display: inline-block;">–î–∏–∞–º–µ—Ç—Ä:</label>
      <select id="columnDiameter" style="width: 250px;">
        <option value="1.5">1.5 –¥—é–π–º–∞ (38 –º–º)</option>
        <option value="2" selected>2.0 –¥—é–π–º–∞ (50 –º–º)</option>
        <option value="3">3.0 –¥—é–π–º–∞ (76 –º–º)</option>
      </select>
    </div>

    <div class="prgline" style="margin-bottom: 10px;">
      <label class="prglabel" style="width: 150px; display: inline-block;">–í—ã—Å–æ—Ç–∞:</label>
      <select id="columnHeight" style="width: 250px;"></select>
    </div>

    <!-- –ú–æ—â–Ω–æ—Å—Ç—å –¢–≠–ù–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è —Ä–µ–∂–∏–º–∞ –≤–æ–ª—å—Ç) -->
    <div id="heaterPowerBlock" class="prgline" style="margin-bottom: 10px; display: none;">
      <label class="prglabel" style="width: 150px; display: inline-block;">–ú–æ—â–Ω–æ—Å—Ç—å –¢–≠–ù–∞:</label>
      <input type="text" id="heaterMaxPower" value="3500" style="width: 212px;">
      <span class="prgline">–í—Ç</span>
    </div>

    <div class="prgline" style="margin-bottom: 15px;">
      <label class="prglabel" style="width: 150px; display: inline-block;">–ü–ª–æ—Ç–Ω–æ—Å—Ç—å:</label>
      <input type="range" id="packingDensity" min="60" max="100" value="80" step="5" style="width: 250px; vertical-align: middle;">
      <span id="packingDensityValue" style="font-weight: bold; color: #3498db; margin-left: 10px;">80&#37;</span>
      <span id="packingDensityDesc" style="font-size: 0.9em; color: #777; margin-left: 5px;">(–°—Ä–µ–¥–Ω—è—è)</span>
    </div>
    
    <div id="columnParamsResults" style="display: none; background: #fff; border: 1px solid #3498db; padding: 15px; border-radius: 4px; margin: 10px;">
      <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 15px; border-bottom: 1px dashed #ccc; padding-bottom: 10px;">
        <div style="flex: 1; min-width: 120px;">
          <div style="font-size: 0.8em; color: #777;">–ó–ê–•–õ–Å–ë</div>
          <div style="font-size: 1.2em; font-weight: bold; color: #333;"><span id="colFloodPower">-</span> –í—Ç</div>
        </div>
        <div style="flex: 1; min-width: 120px;">
          <div style="font-size: 0.8em; color: #777;">–†–ê–ë–û–ß–ê–Ø</div>
          <div style="font-size: 1.2em; font-weight: bold; color: #333;"><span id="colWorkingPower">-</span> –í—Ç</div>
        </div>
        <div style="flex: 1; min-width: 120px;">
          <div style="font-size: 0.8em; color: #777;">–û–¢–ë–û–† (–ú–ê–ö–°)</div>
          <div style="font-size: 1.2em; font-weight: bold; color: #333;"><span id="colMaxFlow">-</span> –º–ª/—á</div>
        </div>
        <div style="flex: 1; min-width: 120px;">
          <div style="font-size: 0.8em; color: #777;">–¢–ê–†–ï–õ–û–ö</div>
          <div style="font-size: 1.2em; font-weight: bold; color: #333;"><span id="colTheoreticalPlates">-</span></div>
        </div>
      </div>
      
      <div style="margin-bottom: 15px;">
        <div style="color: #3498db; font-weight: bold; margin-bottom: 5px;">–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å–∫–æ—Ä–æ—Å—Ç–∏:</div>
        <div style="font-size: 1.1em; color: #555;">
          –ì–æ–ª–æ–≤—ã: <b id="colHeadsSpeed">-</b> –ª/—á | 
          –¢–µ–ª–æ: <b id="colBodySpeedMin">-</b>...<b id="colBodySpeedMax">-</b> –ª/—á | 
          –•–≤–æ—Å—Ç—ã: <b id="colTailsSpeed">-</b> –ª/—á
        </div>
        <div id="strategyNote" style="margin-top: 10px; font-size: 0.9em; padding: 8px; border-radius: 4px; background: #f9f9f9;"></div>
      </div>
      
      <input type="button" class="button" value="–ü–†–ò–ú–ï–ù–ò–¢–¨ –ü–ê–†–ê–ú–ï–¢–†–´ –ö –ü–†–û–ì–†–ê–ú–ú–ï" onclick="applyRecommendedSpeeds()" style="width: 100%; margin: 0; background-color: #3498db; height: 40px;">
    </div>
  </div>
</div>
</div>

<div class="tabcontent" style="display: block;border-top: solid;border-top-width: 1px;border-top-color: rgb(204, 204, 204);">

<div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em;">
<div id="Prog">
<div style="margin-bottom: 10px !important;">
<label class="tooltip prgline">–û–±—ä–µ–º —Å–ø–∏—Ä—Ç–∞-—Å—ã—Ä—Ü–∞</label><input id='vless' type='text' value='12.25' onchange="set_num();"><label class="tooltip prgline">–ª</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label class="tooltip prgline">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –ê–° –≤ —Å-—Å<span class="tooltiptext">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ —Å–ø–∏—Ä—Ç–∞ –≤ —Å–ø–∏—Ä—Ç–µ-—Å—ã—Ä—Ü–µ –≤ &#37;</span></label><input id='vlssp' type='text' value='34' onchange="set_num();"><label class="tooltip prgline">&#37;</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label class="tooltip prgline">–í—ã—Ö–æ–¥ —Å–ø–∏—Ä—Ç–∞<span class="tooltiptext">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –≤—ã—Ö–æ–¥ —Å–ø–∏—Ä—Ç–∞ –≤ &#37;</span></label><input id='vlp' type='text' value='94' onchange="set_num();"><label class="tooltip prgline">&#37;</label>
</div>
<div style="margin-top: 10px !important; padding-bottom: 0px !important; margin-bottom: 10px !important;">
<label class="tooltip prgline">–û–±—ä–µ–º –≥–æ–ª–æ–≤<span class="tooltiptext">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –≤—ã—Ö–æ–¥ –≥–æ–ª–æ–≤ –≤ &#37;</span></label><input id='vlhp' type='text' value='8' onchange="set_num();"><label class="tooltip prgline">&#37;</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label class="tooltip prgline">–û–±—ä–µ–º —Ö–≤–æ—Å—Ç–æ–≤<span class="tooltiptext">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –≤—ã—Ö–æ–¥ —Ö–≤–æ—Å—Ç–æ–≤ –≤ &#37;</span></label><input id='vltp' type='text' value='5' onchange="set_num();"><label class="tooltip prgline">&#37;</label>&nbsp;&nbsp;&nbsp;&nbsp;
<label class="tooltip prgline">–ö—É–±–æ–≤—ã–π –æ—Å—Ç–∞—Ç–æ–∫<span class="tooltiptext">–ü—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ–º—ã–π –∫—É–±–æ–≤—ã–π –æ—Å—Ç–∞—Ç–æ–∫ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø–µ—Ä–µ–≥–æ–Ω–∫–∏ –≤ –ª–∏—Ç—Ä–∞—Ö</span></label><input id='trest' type='text' value='8' disabled><label class="tooltip prgline">–ª</label>
</div>
<label class="tooltip prgline" style="margin-top: 10px !important; padding-bottom: 0px !important; margin-bottom: 10px !important;">–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã –æ—Ç–±–æ—Ä–∞
<span class="tooltiptext">
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –°–° –∏–∑ —Å–∞—Ö–∞—Ä–Ω–æ–π –±—Ä–∞–≥–∏
<ul>
<li>–ö–æ–ª–æ–Ω–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –≤—ã—Å–æ—Ç—ã, –ø–ª–æ—Ç–Ω–æ –Ω–∞–±–∏—Ç–∞—è –Ω–∞—Å–∞–¥–∫–∞</li>
<li>–û—Ç–±–æ—Ä - –≥–æ–ª–æ–≤—ã –≤ –ø–ª–µ–Ω–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ, —Ç–µ–ª–æ –≤ —Ä–µ–∂–∏–º–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–≥–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (–ø—Ä–µ–¥–∑–∞—Ö–ª–µ–±)</li>
<li>–ì–æ–ª–æ–≤—ã - 10&#37;-15&#37;, —Ö–≤–æ—Å—Ç—ã - 5&#37;</li>
</ul>
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –°–° –∏–∑ —Ñ—Ä—É–∫—Ç–æ–≤
<ul>
<li>–ö–æ–ª–æ–Ω–Ω–∞ –º–µ—Ç—Ä, —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –Ω–∞—Å–∞–¥–∫–∞</li>
<li>–ù–∞—á–∞–ª–æ –æ—Ç–±–æ—Ä–∞ –≤ –ø–ª–µ–Ω–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ</li>
<li>–ü–æ—Å–ª–µ –æ—Ç–±–æ—Ä–∞ –≥–æ–ª–æ–≤ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, –Ω–æ –Ω–µ –¥–æ–≤–æ–¥–∏—Ç—å –¥–æ –ø—Ä–µ–¥–∑–∞—Ö–ª–µ–±–∞</li>
<li>–ì–æ–ª–æ–≤—ã - 8&#37;, —Ö–≤–æ—Å—Ç—ã - 5&#37;</li>
<li>–í—ã—Ö–æ–¥ —Å–ø–∏—Ä—Ç–∞ - 94&#37;</li>
</ul>
–ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –°–° –∏–∑ –∑–µ—Ä–Ω–æ–≤—ã—Ö
<ul>
<li>–ö–æ–ª–æ–Ω–Ω–∞ –º–µ—Ç—Ä, —Ä–∞–∑—Ä–µ–∂–µ–Ω–Ω–∞—è –Ω–∞—Å–∞–¥–∫–∞</li>
<li>–ù–∞—á–∞–ª–æ –æ—Ç–±–æ—Ä–∞ –≤ –ø–ª–µ–Ω–æ—á–Ω–æ–º —Ä–µ–∂–∏–º–µ</li>
<li>–ü–æ—Å–ª–µ –æ—Ç–±–æ—Ä–∞ –≥–æ–ª–æ–≤ —É–≤–µ–ª–∏—á–∏—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ, –Ω–æ –Ω–µ –¥–æ–≤–æ–¥–∏—Ç—å –¥–æ –ø—Ä–µ–¥–∑–∞—Ö–ª–µ–±–∞</li>
<li>–ì–æ–ª–æ–≤—ã - 6-10&#37;, —Ö–≤–æ—Å—Ç—ã - 5-7&#37;</li>
<li>–í—ã—Ö–æ–¥ —Å–ø–∏—Ä—Ç–∞ - 94&#37;</li>
</ul>
</span></label>
</div>
</div>

<div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em;">
<div class="prg" id="prg"></div>
</div>
<div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em;">
<div>
<label class="tooltip prgline">–ò—Ç–æ–≥–æ–≤–æ–µ –≤—Ä–µ–º—è –æ—Ç–±–æ—Ä–∞<span class="tooltiptext">–í—Ä–µ–º—è, –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –¥–ª—è —Ä–µ–∫—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å–ø–∏—Ä—Ç–∞-—Å—ã—Ä—Ü–∞ —Å –∑–∞–¥–∞–Ω–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏</span></label><input id='sum' type='text' value='' disabled>
</div>
</div>

<div>
<textarea cols="40" rows="15" id='WProgram1' name='WProgram1' style="visibility: hidden;position: absolute;width: 20;"></textarea>
<textarea cols="40" rows="15" id='WProgram' name='WProgram' style="visibility: hidden;position: absolute;width: 20;">%WProgram%</textarea>
</div>

<div class="container_row" style="border: 1px dashed #bbb; margin-bottom: 1em;">
<div style="margin: 0 auto; width: 200px;">
<input id='saveform' type='button' name='saveform' value='–°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ä–∞—Å—á–µ—Ç' onclick='SaveProgramToFile();' class="button">
</div>
<div style="margin: 0 auto; width: 200px;">
<label for="fileToLoad" class="button custom-file-upload">
    <i class="fa fa-cloud-upload"></i> –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ä–∞—Å—á–µ—Ç 
</label>
<input type="file" id="fileToLoad" accept="text/plain" onchange="loadFile(this.files[0])" class="button"/>
</div>
</div>
<div style="margin: 0 auto; width: 450px;">
<input id='setprogram' type='button' name='setprogram' value='–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É' onclick='set_program();' class="button">
<input id='return' type='button' name='return' value='–ù–∞ –≥–ª–∞–≤–Ω—É—é' onclick='javascript:location.href="index.htm"' class="button">
</div>
</div>
</form>
</body>
</html>