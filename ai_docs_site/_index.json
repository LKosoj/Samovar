{
  "generated_at": "2026-02-01T15:13:48.140354Z",
  "docs_dir": ".ai-docs",
  "rules": {
    "priority": [
      "modules/index.md",
      "modules/*",
      "index.md",
      "architecture.md",
      "conventions.md"
    ],
    "ranking": "keyword frequency + file priority",
    "usage": "use this index to choose a narrow route before reading full docs"
  },
  "sections": [
    {
      "id": "architecture",
      "title": "Архитектура",
      "path": "architecture.md"
    },
    {
      "id": "runtime",
      "title": "Запуск и окружение",
      "path": "runtime.md"
    },
    {
      "id": "dependencies",
      "title": "Зависимости",
      "path": "dependencies.md"
    },
    {
      "id": "conventions",
      "title": "Соглашения",
      "path": "conventions.md"
    },
    {
      "id": "glossary",
      "title": "Глоссарий",
      "path": "glossary.md"
    }
  ],
  "modules": [
    {
      "name": "distiller",
      "path": "modules/distiller.md",
      "source_path": "distiller.h",
      "summary": "Модуль реализует логику управления процессом дистилляции в устройстве \"Самовар\", включая контроль нагрева, насоса, клапанов, сбор данных и прогнозирование времени. Поддерживает работу с датчиками, ПИД-регулирование скорости насоса, обработку аварийных ситуаций и взаимодействие с пользователем через сообщения. Интегрирован с внешними системами (MQTT) и обеспечивает сохранение данных сессии."
    },
    {
      "name": "lua",
      "path": "modules/lua.md",
      "source_path": "lua.h",
      "summary": "Модуль обеспечивает интеграцию скриптового языка Lua в систему управления самоваром, позволяя гибко программировать логику работы устройства. Он предоставляет API для взаимодействия Lua-скриптов с аппаратной частью: реле, датчиками, шаговым двигателем, насосом и расширителями портов. Скрипты могут управлять режимами нагрева, клапанами, таймерами и получать данные о состоянии системы. Выполнение скриптов происходит в отдельной задаче FreeRTOS, что обеспечивает асинхронную работу без блокировки основного цикла."
    },
    {
      "name": "crash_handler",
      "path": "modules/crash_handler.md",
      "source_path": "crash_handler.ino",
      "summary": "/** * @brief Модуль обработки сбоев для ESP32 с сохранением отладочной информации в SPIFFS."
    },
    {
      "name": "impurity_detector",
      "path": "modules/impurity_detector.md",
      "source_path": "impurity_detector.h",
      "summary": "Модуль `impurity_detector` предназначен для автоматического обнаружения примесей в процессе дистилляции на основе анализа температуры колонны. Он отслеживает динамику температуры, вычисляет тренды, дисперсию и последовательные повышения, чтобы определить моменты перехода между фракциями. Модуль поддерживает грейс-периоды после старта и ручного вмешательства, а также блокировку детекции при нестабильном паре."
    },
    {
      "name": "sensorinit",
      "path": "modules/sensorinit.md",
      "source_path": "sensorinit.h",
      "summary": "Модуль `Samovar_S_I` предоставляет функциональность для управления самоваром, включая загрузку программ в зависимости от режима работы, обработку данных с датчиков температуры, давления и окружающей среды. Модуль поддерживает взаимодействие с датчиками DS18B20, BME680, BMP180, BMP280, BME280, XGZP6897D, MPX5010D через шины OneWire и I2C, реализует коррекцию температуры по атмосферному давлению и поддерживает режимы пивоварения, сувид, дистилляции и НБК. Также обеспечивается интеграция с Lua-скриптами и управление насосом через ШИМ."
    },
    {
      "name": "Blynk",
      "path": "modules/Blynk.md",
      "source_path": "Blynk.ino",
      "summary": "Модуль обеспечивает интеграцию устройства «Самовар» с платформой Blynk для удалённого мониторинга и управления через веб-интерфейс. Реализованы функции чтения температур, давления, объёмов, статусов и режимов работы, а также управления мощностью, насосом и программами. Поддерживается Lua-терминал для выполнения пользовательских скриптов при включённой опции USE_LUA."
    },
    {
      "name": "quality",
      "path": "modules/quality.md",
      "source_path": "quality.h",
      "summary": "Модуль `Quality` предназначен для оценки качества процесса дистилляции на основе температурных показателей и стабильности работы самовара. Он анализирует текущие данные с датчика пара, вычисляет метрики качества по нескольким критериям и формирует общую оценку с рекомендациями. Основные показатели включают стабильность температуры, соответствие температуры пару идеальным значениям для этанола и общую оценку качества. Результаты используются для контроля и оптимизации процесса дистилляции."
    },
    {
      "name": "mod_rmvk",
      "path": "modules/mod_rmvk.md",
      "source_path": "mod_rmvk.h",
      "summary": "/** * @brief Модуль предоставляет интерфейс для взаимодействия с устройством РМВ-К через UART."
    },
    {
      "name": "BK",
      "path": "modules/BK.md",
      "source_path": "BK.h",
      "summary": "/** * @file SamovarBk.h"
    },
    {
      "name": "column_math",
      "path": "modules/column_math.md",
      "source_path": "column_math.h",
      "summary": "Модуль для расчета параметров ректификационной колонны на основе эталонной модели. Выполняет вычисление рабочих мощностей, потоков и теоретического числа тарелок"
    },
    {
      "name": "SPIFFSEditor",
      "path": "modules/SPIFFSEditor.md",
      "source_path": "SPIFFSEditor.h",
      "summary": "SPIFFSEditor — это веб-обработчик для асинхронного сервера ESPAsyncWebServer, обеспечивающий доступ к файловой системе SPIFFS (или другой файловой системе на ESP32/ESP8266) через веб-интерфейс. Он позволяет просматривать список файлов, редактировать, загружать и удалять файлы в SPIFFS. Поддерживается фильтрация файлов через список исключений с подстановочными знаками (`*`, `?`), а также опциональная интеграция с Lua-скриптами."
    },
    {
      "name": "font",
      "path": "modules/font.md",
      "source_path": "font.h",
      "summary": "/** * @brief Модуль определения пользовательских символов для отображения на LCD-экране."
    },
    {
      "name": "Samovar",
      "path": "modules/Samovar.md",
      "source_path": "Samovar.ino",
      "summary": "Модуль представляет собой комплексное программное обеспечение для управления самоваром на базе ESP32 с поддержкой множества датчиков, интерфейсов и режимов работы (дистилляция, пивоварение и др.). Он включает в себя логику управления температурой, уровнем воды, работой шагового двигателя, а также поддержку веб-интерфейса, OTA-обновлений, MQTT, Blynk и Telegram. Архитектура модуля построена на использовании асинхронных серверов, PID-регулирования, EEPROM/NVS-хранилища профилей и обработки внешних событий через прерывания."
    },
    {
      "name": "Samovar_pin",
      "path": "modules/Samovar_pin.md",
      "source_path": "Samovar_pin.h",
      "summary": "/** * @brief Модуль управления распиновкой и конфигурацией устройства Самовар в зависимости от типа платы и режима работы."
    },
    {
      "name": "WebServer",
      "path": "modules/WebServer.md",
      "source_path": "WebServer.ino",
      "summary": "Модуль реализует веб-интерфейс и сетевые функции для управления устройством \"Самовар\" — системой дистилляции, приготовления пива и других процессов. Обеспечивает обработку HTTP-запросов, динамическую генерацию веб-страниц, переключение режимов работы и взаимодействие с файловой системой. Поддерживается сжатие контента (gzip), кэширование и обработка шаблонов для динамического отображения данных."
    },
    {
      "name": "crash_handler",
      "path": "modules/crash_handler.md",
      "source_path": "crash_handler.h",
      "summary": "/** * @brief Модуль обработки сбоев и сохранения стектрейсов для ESP32."
    },
    {
      "name": "partition_manager",
      "path": "modules/partition_manager.md",
      "source_path": "partition_manager.py",
      "summary": "Модуль предназначен для интеграции инструмента управления разделами ESP32 в процесс сборки PlatformIO. Он добавляет путь к утилите `esp32partitiontool` в переменную окружения Python и загружает менеджер партиций."
    },
    {
      "name": "FS",
      "path": "modules/FS.md",
      "source_path": "FS.ino",
      "summary": "Модуль реализует веб-интерфейс и WebSocket-обработку для управления устройством Samovar через встроенный веб-сервер на базе ESPAsyncWebServer. Обеспечивает взаимодействие с файловой системой SPIFFS, хранение конфигураций, обработку WebSocket-событий и отладочную печать. Включает функции форматирования данных, инициализации файловой системы и отправки сообщений. Предназначен для использования в системах автоматического контроля приготовления напитков."
    },
    {
      "name": "Samovar",
      "path": "modules/Samovar.md",
      "source_path": "Samovar.h",
      "summary": "Модуль управления самоваром на базе ESP32 с поддержкой PID-регулирования, веб-интерфейса и различных датчиков. Обеспечивает управление нагревом, уровнем жидкости, давлением и другими параметрами в системе самовара. Поддерживается асинхронный веб-сервер, локальное управление через энкодер и LCD, а также удалённый мониторинг и настройка через WebSocket и mDNS. Используются семафоры для синхронизации задач."
    },
    {
      "name": "wifi_htm_gz",
      "path": "modules/wifi_htm_gz.md",
      "source_path": "wifi_htm_gz.h",
      "summary": "Модуль предоставляет доступ к сжатым в формате gzip статическим данным, представляющим собой HTML-страницу для настройки Wi-Fi (wifi.htm). Данные хранятся в PROGMEM (Flash-памяти) для экономии оперативной памяти на микроконтроллерах, типично используемых в embedded-системах, таких как ESP8266 или ESP32. Массив может использоваться веб-сервером, работающим на устройстве, для отдачи конфигурационной страницы при подключении клиента."
    },
    {
      "name": "SamovarMqtt",
      "path": "modules/SamovarMqtt.md",
      "source_path": "SamovarMqtt.h",
      "summary": "/** * @brief Модуль управления MQTT-клиентом для устройства Samovar."
    },
    {
      "name": "logic",
      "path": "modules/logic.md",
      "source_path": "logic.h",
      "summary": "Модуль управления логикой работы самоварной установки с поддержкой дистанционного мониторинга, автоматического отбора фракций и защиты по температуре/давлению. Модуль реализует основную логику управления процессом дистилляции: автоматический отбор фракций, контроль температуры и давления, обработку программ отбора, взаимодействие с шаговым двигателем, насосом и датчиками. Поддерживает интеграцию с Blynk (опционально) и детектирование примесей. Обеспечивает аварийное отключение при критических отклонениях параметров."
    },
    {
      "name": "Samovar_ini",
      "path": "modules/Samovar_ini.md",
      "source_path": "Samovar_ini.h",
      "summary": "/** * @file samovar_i.h"
    },
    {
      "name": "pumppwm",
      "path": "modules/pumppwm.md",
      "source_path": "pumppwm.h",
      "summary": "Модуль управления водяным насосом для системы Samovar, реализующий PID-регулирование скорости насоса в зависимости от температуры. Использует библиотеку GyverPID для формирования управляющего сигнала и ESP32PWM для генерации ШИМ-сигнала на выводе насоса."
    },
    {
      "name": "beer",
      "path": "modules/beer.md",
      "source_path": "beer.h",
      "summary": "Модуль реализует логику управления самоваром для пивоварения, включая контроль температуры, управление нагревателем по ПИД-регулятору, обработку программ затирания, контроль кипения, взаимодействие с периферией (насос, клапаны, мешалка, шаговый двигатель) и обмен данными через MQTT. Поддерживает сохранение профилей, автотюнинг ПИД, обработку ошибок питания и отправку уведомлений. Основное состояние процесса управляется через программу затирания с переходами между этапами."
    },
    {
      "name": "I2CStepper",
      "path": "modules/I2CStepper.md",
      "source_path": "I2CStepper.h",
      "summary": "Модуль управления шаговым двигателем по шине I2C. Предоставляет функции для управления шаговым двигателем через I2C-интерфейс, а также поддерживает локальное управление при отсутствии внешнего устройства. Реализована работа с объёмом жидкости, скоростью подачи и конвертация между шагами и объёмом. Управление синхронизировано через семафор для безопасного доступа к шине I2C в многозадачной среде."
    },
    {
      "name": "NVS_Manager",
      "path": "modules/NVS_Manager.md",
      "source_path": "NVS_Manager.ino",
      "summary": "Модуль управления хранением настроек и Wi-Fi параметров для устройства Samovar. Модуль отвечает за сохранение и загрузку пользовательских настроек устройства в энергонезависимую память (NVS), а также за работу с Wi-Fi учетными данными через стандартный интерфейс ESP32 WiFi. Использует Preferences для хранения параметров и стандартный namespace WiFi для управления сетевыми настройками."
    },
    {
      "name": "mod_rmv",
      "path": "modules/mod_rmv.md",
      "source_path": "mod_rmv.ino",
      "summary": "/** * @brief Модуль обеспечивает взаимодействие с устройством RMVK через UART-интерфейс с использованием протокола команд AT."
    },
    {
      "name": "Menu",
      "path": "modules/Menu.md",
      "source_path": "Menu.ino",
      "summary": "Модуль Samovar предоставляет функциональность управления самоваром, включая контроль температуры, управление насосом, настройку программ перегонки, работу с дисплеем на базе LiquidCrystal_I2C и взаимодействие с меню через библиотеку LiquidMenu. Поддерживается конфигурация параметров через EEPROM, калибровка насоса, управление мощностью нагрева и, опционально, интеграция с MQTT для удалённого доступа. Основное назначение — автоматизация процесса дистилляции с контролем температур, давления и объёма отбора."
    },
    {
      "name": "nbk",
      "path": "modules/nbk.md",
      "source_path": "nbk.h",
      "summary": "Модуль управления процессом НБК (непрерывная барботажная колонна) обеспечивает автоматизированное управление технологическим процессом: контроль температуры, подачи, мощности, обработку аварий и захлёбов, а также сбор статистики и взаимодействие с пользователем через сообщения. Реализует конечный автомат по этапам программы — разгон, ручной режим, оптимизация, работа."
    },
    {
      "name": "data/nbk",
      "path": "modules/data/nbk.md",
      "source_path": "data/nbk.htm",
      "summary": "Модуль отвечает за управление интерфейсом и взаимодействие с сервером в веб-приложении для контроля оборудования. Реализует отображение и обработку сообщений, работу с программами управления, отправку команд на сервер и обработку пользовательских действий. Включает функции валидации, анимации, управления звуковыми оповещениями и динамического обновления состояния интерфейса."
    },
    {
      "name": "data/bk",
      "path": "modules/data/bk.md",
      "source_path": "data/bk.htm",
      "summary": "Модуль реализует клиентскую логику веб-интерфейса управления устройством, включая отображение сообщений, обработку пользовательских действий, взаимодействие с сервером через HTTP-запросы и управление состоянием интерфейса. Основные функции — добавление и удаление сообщений с поддержкой тревожных уведомлений, отправка команд, валидация и синхронизация данных программы, а также динамическое обновление состояния элементов интерфейса. Модуль работает с DOM, обрабатывает формы и управляет асинхронными запросами."
    },
    {
      "name": "data/distiller",
      "path": "modules/data/distiller.md",
      "source_path": "data/distiller.htm",
      "summary": "Модуль отвечает за управление интерфейсом веб-страницы дистилляционной установки: отображение и редактирование сообщений, обработку пользовательских действий, отправку команд на сервер, работу с программами и настройками. Основные функции включают добавление и удаление сообщений с поддержкой тревожных уведомлений, отправку HTTP-запросов, управление вкладками и элементами интерфейса. Модуль также обеспечивает динамическое редактирование программ перегонки и взаимодействие с периферийными устройствами через I2C."
    },
    {
      "name": "data/index",
      "path": "modules/data/index.md",
      "source_path": "data/index.htm",
      "summary": "Модуль реализует клиентскую логику управления устройством через веб-интерфейс. Он отвечает за отображение и обработку сообщений, валидацию и расчёт параметров программы, отправку команд на сервер, а также взаимодействие с элементами интерфейса, такими как вкладки, спойлеры и формы ввода. Основное внимание уделено обработке пользовательского ввода, расчёту времени выполнения программы и управлению аудиооповещениями при возникновении тревог."
    },
    {
      "name": "data/wifi",
      "path": "modules/data/wifi.md",
      "source_path": "data/wifi.htm",
      "summary": "Краткий веб-интерфейс для настройки Wi-Fi на устройстве Samovar. Позволяет сохранить или удалить учётные данные сети Wi-Fi."
    },
    {
      "name": "data/calibrate",
      "path": "modules/data/calibrate.md",
      "source_path": "data/calibrate.htm",
      "summary": "/** * @brief Веб-интерфейс для калибровки шагового двигателя насоса."
    },
    {
      "name": "data/program",
      "path": "modules/data/program.md",
      "source_path": "data/program.htm",
      "summary": "Модуль отвечает за управление параметрами программы перегонки, включая расчёт объёмов фракций, времени процесса, валидацию данных и обработку пользовательского ввода. Предоставляет функции для обновления параметров колонны, сохранения и загрузки программ, переключения вкладок интерфейса, а также форматирования и проверки данных программы. Все операции синхронизированы с DOM и реагируют на изменения ввода, обеспечивая корректность расчётов при смене типа сырья или параметров режима."
    },
    {
      "name": "data/edit",
      "path": "modules/data/edit.md",
      "source_path": "data/edit.htm",
      "summary": "Модуль предоставляет веб-интерфейс для редактирования файлов на сервере с использованием Ace Editor, включая древовидную навигацию по файловой системе, контекстные действия, поддержку превью и управление HTTP-запросами через очередь. Реализует асинхронное взаимодействие с сервером для загрузки, сохранения и удаления файлов. Поддерживает определение типа файла по расширению для корректного отображения и редактирования."
    },
    {
      "name": "data/style",
      "path": "modules/data/style.md",
      "source_path": "data/style.css",
      "summary": "Модуль предоставляет набор CSS-стилей для визуализации интерфейса веб-приложения, ориентированного на обработку и отображение данных, включая формы загрузки файлов, панели сообщений, историю операций, вкладки и элементы управления. Стили обеспечивают адаптивность, визуальную обратную связь и удобство взаимодействия."
    },
    {
      "name": "data/setup",
      "path": "modules/data/setup.md",
      "source_path": "data/setup.htm",
      "summary": "Модуль предоставляет функциональность для управления и настройки процессов дистилляции и ректификации в системе \"Самовар\" через веб-интерфейс. Он включает в себя обработку пользовательских действий, взаимодействие с сервером, сериализацию форм, загрузку и сохранение конфигураций, а также валидацию ввода. Основное назначение — обеспечение удобного и надёжного интерфейса для настройки режимов работы, параметров температуры, насоса, НБК и других компонентов."
    },
    {
      "name": "data/beer",
      "path": "modules/data/beer.md",
      "source_path": "data/beer.htm",
      "summary": "Модуль реализует клиентскую часть веб-интерфейса системы управления \"Самовар\", обеспечивая отображение состояния соединения, управление мощностью, обработку пользовательских сообщений, воспроизведение звуковых оповещений и работу с историей сообщений. Поддерживает динамическое формирование интерфейса на основе конфигурации, включая добавление пользовательских кнопок через LUA-скрипты. Обеспечивает уведомления о потерях связи и критических состояниях. Работает в реальном времени, взаимодействуя с сервером через AJAX (не показан в коде)."
    },
    {
      "name": "data/chart",
      "path": "modules/data/chart.md",
      "source_path": "data/chart.htm",
      "summary": "Модуль реализует интерфейс веб-страницы для мониторинга и управления процессом дистилляции. Основные функции включают регулярное обновление данных с сервера по AJAX, отображение температурных и статусных параметров, визуализацию данных на графике с использованием библиотеки amCharts, а также обработку сообщений и звуковых оповещений."
    },
    {
      "name": "data/brewxml",
      "path": "modules/data/brewxml.md",
      "source_path": "data/brewxml.htm",
      "summary": "Модуль обработки пивоваренных рецептов в формате BeerXML и генерации управляющих программ для оборудования. Реализует логику загрузки, парсинга и обработки пивоваренных рецептов в формате BeerXML. Извлекает данные о затирании, кипячении и брожении, формирует последовательность температурных шагов и генерирует управляющую программу для оборудования (например, пивоварни \"Самовар\"). Результат представляет собой текстовый скрипт, соответствующий протоколу управления устройством."
    }
  ],
  "files": [
    "_index.json",
    "architecture.md",
    "changes.md",
    "conventions.md",
    "dependencies.md",
    "glossary.md",
    "index.md",
    "modules/BK__h.md",
    "modules/Blynk__ino.md",
    "modules/FS__ino.md",
    "modules/I2CStepper__h.md",
    "modules/Menu__ino.md",
    "modules/NVS_Manager__ino.md",
    "modules/SPIFFSEditor__h.md",
    "modules/SamovarMqtt__h.md",
    "modules/Samovar__h.md",
    "modules/Samovar__ino.md",
    "modules/Samovar_ini__h.md",
    "modules/Samovar_pin__h.md",
    "modules/WebServer__ino.md",
    "modules/beer__h.md",
    "modules/column_math__h.md",
    "modules/crash_handler__h.md",
    "modules/crash_handler__ino.md",
    "modules/data/beer__htm.md",
    "modules/data/bk__htm.md",
    "modules/data/brewxml__htm.md",
    "modules/data/calibrate__htm.md",
    "modules/data/chart__htm.md",
    "modules/data/distiller__htm.md",
    "modules/data/edit__htm.md",
    "modules/data/index__htm.md",
    "modules/data/nbk__htm.md",
    "modules/data/program__htm.md",
    "modules/data/setup__htm.md",
    "modules/data/style__css.md",
    "modules/data/wifi__htm.md",
    "modules/distiller__h.md",
    "modules/font__h.md",
    "modules/impurity_detector.md",
    "modules/impurity_detector__h.md",
    "modules/index.md",
    "modules/logic__h.md",
    "modules/lua__h.md",
    "modules/mod_rmv__ino.md",
    "modules/mod_rmvk__h.md",
    "modules/nbk__h.md",
    "modules/partition_manager__py.md",
    "modules/pumppwm__h.md",
    "modules/quality__h.md",
    "modules/sensorinit__h.md",
    "modules/wifi_htm_gz__h.md",
    "runtime.md"
  ]
}
